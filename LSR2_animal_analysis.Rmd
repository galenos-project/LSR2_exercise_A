---
title: "LSR2 analysis: Mechanisms through which exercise reduces symptom severity and/or functional impairment in posttraumatic stress disorder (PTSD)"
author: "Francesca Tinsdeall, Fiona Ramage, Virginia Chiocchia and Malcolm Macleod"
date: "2024-02-20"
output: 
  html_document: 
    fig_width: 9
    toc: TRUE
bibliography: grateful-refs.bib
editor_options: 
  chunk_output_type: console
---

Date report generated: `r Sys.Date()`

```{r setup, message=F, echo=F, include=F}
### libraries
library(devtools)
library(dosresmeta)
library(dplyr)
library(grid)
library(gtools)
library(kableExtra)
library(graphics)
library(patchwork)
library(forcats)
library(knitr)
library(ggplot2)
library(Matrix)
library(meta)
library(metafor)
library(orchaRd)
library(readxl)
library(readr)
library(rje)
library(rms)
library(stringr)
library(tibble)
library(tidyr)
library(tools)
library(rlang)
#devtools::install_github("mcguinlu/robvis")
#install_github("mcguinlu/robvis")
library(robvis)
library(PRISMA2020)
library(grateful)
library(xtable)
library(scales)


#define LSR

LSR <- 'LSR2'
# define date of processing
DoP <- Sys.Date()


# All function needed to run this notebook (analyses, etc.) should be in a util.R file
source("utils/util.R")

# obtain the data and prepare them for analysis - all data cleaning routines should be in this .R script 


source("wrangling/wrangling_functions.R", local = TRUE)
source("wrangling/data_wrangle_script.R")
source("utils/development.R")

#Round off results to two digits
options(scipen=100, digits=3)

# Import data
file2load <- paste0(LSR,'_clean_data_',DoP,'.csv')
df <- read_csv(file2load)

```

# 1. Flow of study selection and descriptives

```{r article metadata, eval = TRUE, echo = FALSE}
# Retrieve article metadata omitted from 'clean_data.csv' and join 

article_metadata <- df %>% 
  select(StudyId, Title, Year) %>%
  distinct()
```

The flow of study selection is shown in Figure 1. Studies included were published between `r min(article_metadata$Year)` and `r max(article_metadata$Year)`. Overall, this analysis includes `r length(table(df$StudyId))` studies containing `r nrow(df)` comparisons.

**Figure 1**

```{r PRISMA flowchart, eval = TRUE, echo = FALSE, warning=FALSE, message=FALSE}
prisma_data <- read_csv("data/LSR2_prisma_200224.csv")
dfp <- PRISMA_data(prisma_data)
PRISMA_flowdiagram(dfp, interactive=FALSE, previous=FALSE, other=FALSE,
                    detail_databases=FALSE, detail_registers=FALSE, fontsize=12, font="Helvetica",
                    title_colour="Goldenrod1", greybox_colour="Gainsboro", main_colour="Black",
                    arrow_colour="Black", arrow_head="normal", arrow_tail="none", side_boxes=TRUE )
```

```{r Included studies, eval = TRUE, echo = FALSE, warning=FALSE, message=FALSE}
RoB <- unique(df[,c(4,6,12)])

#change studyId to Author, year
RoB$Study <- RoB$StudyId_I
RoB$StudyId <- toupper(paste0(str_extract(RoB$Authors_I,"\\b\\w+\\b"),', ',RoB$Year_I))

# fix >1 publication per first author in a year
unique_study_ids <- unique(RoB$StudyId)
suffix_list <- character(length = nrow(RoB))

for (study_id in unique_study_ids) {
  indices <- RoB$StudyId == study_id
  if (sum(indices) > 1) {
    suffix_list[indices] <- letters[seq_along(suffix_list[indices])]
  }
}

RoB$suffix <- suffix_list

# Add the suffix to the original column
RoB$StudyId <- paste(RoB$StudyId, RoB$suffix, sep = "")

# Remove the 'suffix' column if you no longer need it
RoB <- select(RoB, -suffix)
RoB <- RoB[order(RoB$StudyId),]

colnames(RoB) <- c('Study', 'Authors', 'Year', 'StudyId')

colnamesdf <- c('StudyId_I', 'Authors_I','Year_I','Strain', 'Label', 'outcome_type',
                'NumberOfAnimals', 'NumberOfAnimals_C', 'NumberOfAnimals_I', 'SortLabel')
df3 <- df[,colnamesdf]
df3$N <- as.numeric(df3$NumberOfAnimals_C) + as.numeric(df3$NumberOfAnimals_I)
df3$CompLable <- df3$Label

trow <- merge(df3, RoB, by.x = 'StudyId_I', by.y = 'StudyId')
colnames(trow)[16] <- "Id"
trowmodel <- subset(trow, trow$SortLabel == 'CvS')
trowint <- subset(trow, trow$SortLabel =='TvC')
tab1m <- trowmodel[,c(16,4,6,11)]
tab1i <- trowint[,c(16,4,5,6,11)]
tab2i <- tab1i %>%
  group_by(Id, Strain, Label, outcome_type) %>%
  summarise(subjects_sum = sum(N))
tab2m <- tab1m %>%
  group_by(Id, Strain, outcome_type) %>%
  summarise(subjects_sum = sum(N))


colnames(tab2i) <- c("Study", "Strain", "Comparison", "Outcome","N")
colnames(tab2m) <- c("Study", "Strain", "Outcome","N")

tab2m <- tab2m %>%
  arrange(Study, Strain, Outcome)

tab2i <- tab2i %>%
  arrange(Study, Strain, Comparison, Outcome)

write.csv(tab2i, 'tab2i.csv')
write.csv(tab2m, 'tab2m.csv')
```

**Table 1** below gives a summary of the included studies for the effect of exercise interventions. N represents an aggregate of animals contributing to outcomes reported from control and treatment groups, and if the same control group has contributed to more than one experiment, it will be counted twice.

```{r results="asis", echo = FALSE, warning=FALSE, message=FALSE}

tab2i <- read_csv("data/tab2i.csv")
tab2i$N <- as.numeric(tab2i$N)

original_data <- tab2i
# Rows to have bold lines beneath
rows_with_bold_lines <- c(2,6,10,15,18,23,25,28,31,34,36,40)

# Generate HTML table with adjusted styles
cat('<div style="text-align: center;">')
cat('<table style="width: 100%; border-collapse: collapse;">')

# Table header
cat('<tr style="border-bottom: 2px solid black;">')
for (col_name in names(original_data)) {
  cat(paste('<th style="padding: 8px; text-align: center;">', col_name, '</th>', sep = ''))
}
cat('</tr>')

# Table rows
for (i in seq_len(nrow(original_data))) {
  cat('<tr>')
  for (j in seq_len(ncol(original_data))) {
    cell_content <- original_data[i, j]
    cell_style <- ifelse(i %in% rows_with_bold_lines, 'border-bottom: 2px solid black; padding: 8px; text-align: center;', 'border-bottom: 1px solid black; padding: 8px; text-align: center;')
    if (j == 1) {
      cell_style <- gsub('text-align: center;', 'text-align: left;', cell_style)
    }
    if (i == nrow(original_data)) {
      cell_style <- gsub('border-bottom: 1px solid black;', 'border-bottom: 2px solid black;', cell_style)
    }
    cat(paste('<td style="', cell_style, '">', cell_content, '</td>', sep = ''))
  }
  cat('</tr>')
}

cat('</table>')
cat('</div>')



```

**Table 2** below gives a summary of the included studies for the effect of model induction. N represents an aggregate of animals contributing to outcomes reported from control and treatment groups, and if the same control group has contributed to more than one experiment, those animals will be counted more than once.

```{r results="asis", echo = FALSE, warning=FALSE, message=FALSE}

tab2m <- read_csv("data/tab2m.csv")
tab2m$N <- as.numeric(tab2m$N)

original_data <- tab2m
# Rows to have bold lines beneath
rows_with_bold_lines <- c(1,2,5,9,14,17,22,24,27,30,33,35,39)

# Generate HTML table with adjusted styles
cat('<div style="text-align: center;">')
cat('<table style="width: 100%; border-collapse: collapse;">')

# Table header
cat('<tr style="border-bottom: 2px solid black;">')
for (col_name in names(original_data)) {
  cat(paste('<th style="padding: 8px; text-align: center;">', col_name, '</th>', sep = ''))
}
cat('</tr>')

# Table rows
for (i in seq_len(nrow(original_data))) {
  cat('<tr>')
  for (j in seq_len(ncol(original_data))) {
    cell_content <- original_data[i, j]
    cell_style <- ifelse(i %in% rows_with_bold_lines, 'border-bottom: 2px solid black; padding: 8px; text-align: center;', 'border-bottom: 1px solid black; padding: 8px; text-align: center;')
    if (j == 1) {
      cell_style <- gsub('text-align: center;', 'text-align: left;', cell_style)
    }
    if (i == nrow(original_data)) {
      cell_style <- gsub('border-bottom: 1px solid black;', 'border-bottom: 2px solid black;', cell_style)
    }
    cat(paste('<td style="', cell_style, '">', cell_content, '</td>', sep = ''))
  }
  cat('</tr>')
}

cat('</table>')
cat('</div>')



```

References of included studies are located in the appendix. Included studies used `r length(table(df$ModelID))` unique disease model induction procedures.

## 1.1 Description of experiment types and methodological approach

Within the literature we identified distinct categories of experiments and the data presented would allow several meta-analytical contrasts to be drawn:

**Treatment vs control**. These were experiments investigating the effect of performing exercise, reported in `r nrow(df %>% filter(SortLabel == "TvC"))` experiments from `r nrow(df %>% filter(SortLabel == "TvC") %>% distinct(StudyId))` publications.

In these studies the:

-   **Control group** is a group of animals that is (1) subjected to a PTSD model induction paradigm and (2) administered a control treatment (vehicle) or no treatment.

-   **Intervention group** is a group of animals that is (1) subjected to a PTSD model induction paradigm and (2) performing exercise.

-   **Sham group** is a group of animals that is (1) not subjected to a PTSD model induction paradigm and (2) administered a control treatment (vehicle) or no treatment. These data are required to allow a 'normalised mean difference' effect size to be calculated, given by

$$
\frac{{\bar{\mu}_C - \bar{\mu}_T}}{{\bar{\mu}_C - \bar{\mu}_S}} \times 100
$$

where $\bar{\mu}_C$, $\bar{\mu}_T$, $\bar{\mu}_S$ are the mean reported scores in the control, treatment, and sham groups respectively.

**Effects of disease modelling**. These are experiments investigating the effect of models of PTSD, reported in `r nrow(df %>% filter(SortLabel == "CvS"))` experiments from `r nrow(df %>% filter(SortLabel == "CvS") %>% distinct(StudyId))` publications.

In these studies the:

-   **Control group** is a group of animals that is (1) not subjected to a PTSD model induction paradigm and (2) is administered a control treatment (vehicle) or no treatment.

-   **Intervention group** is a group of animals that is (1) subjected to a PTSD model induction paradigm and (2) is administered a control treatment (vehicle) or no treatment.

Outcomes with ≥2 independent effect sizes were considered for meta-analysis. In this iteration of the review, this includes `r df %>% group_by(outcome_type) %>% filter(n_distinct(StudyId) > 1) %>% summarise(n = n_distinct(StudyId)) %>% arrange(desc(n)) %>% pull(outcome_type) %>% unique() %>% tolower() %>% { if (length(.) > 1) paste(paste(head(., -1), collapse = ", "), "and", tail(., 1)) else .}`.

All analyses were conducted allowing for the following hierarchical levels in a random effects model, which accounts for features common to experimental contrasts such as a shared control group:

-   **Level 1: Rodent strain** - effect sizes measured across experiments using the same rodent strain.

-   **Level 2: Study** - effect sizes measured from different experiments presented in the same publication.

-   **Level 3: Experiment** - effect sizes measured in the same experiment within a study, where often a control group contributes to several effect sizes.

Each level for the hierarchy was only included in the model if more than 4 categories were present for at least one of these levels. Where more than 4 categories are not present for all levels, the variance attributable to levels with fewer than 5 categories is reported as zero.

The hierarchical grouping may therefore be considered thus: **Strains** of laboratory animals are included in several **Studies**, each of which can report one or more **Experiments**, and each Experiment is comprised of at least two **Cohorts** which are considered identical except for differing in the experimental manipulation (the **Intervention**) or not being exposed to the disease modelling procedures (a **Sham** cohort, these only being used to provide a baseline for outcome measures to allow Normalised Mean Difference meta-analysis). An **Experiment** can include several **experimental contrasts**, for instance where different doses of drugs are compared to the same control group. Several outcomes can be measured and reported from the same cohort of animals.

We constructed multilevel models without Hartung-Knapp adjustments as these are not available for rma.mv class objects in the metafor package. Instead, the model is set to `test = "t"` to use t- and F-distributions for making inferences, and `dfs="contain"` to improve the method of approximating degrees of freedom of these distributions.

The scales and units used to measure outcomes in preclinical studies often differ between studies although they may measure the same underlying biological construct. The primary effect size used for meta-analysis of preclinical studies is therefore the standardised mean difference (SMD, Hedge's g). For experiments testing the effects of interventions we also present a sensitivity analysis using normalised mean difference (NMD), where there are sufficient data for sham procedures to allow this. This analysis is not possible for studies of the effect of single prolonged stress (SPS).

# 2 Exercise v Control

```{r # Split df by experiment and outcome type into dataframes to simply inline code below - Exercise v Control, eval = TRUE, echo = FALSE}
df_S <- filter(df, SortLabel == "TvC")
df_S_NT <- filter_experiment_outcome_type(df, "TvC", "Neurotransmitter levels")
df_S_L <- filter_experiment_outcome_type(df, "TvC", "Locomotor")
df_S_B <- filter_experiment_outcome_type(df, "TvC", "BDNF")
df_S_OB <- filter_experiment_outcome_type(df, "TvC", "Other behavioural")
df_S_OthN <- filter_experiment_outcome_type(df, "TvC", "Other neurobiological")
df_S_FM <- filter_experiment_outcome_type(df, "TvC", "Fear memory")
df_S_Fr <- filter_experiment_outcome_type(df, "TvC", "Freezing")
df_S_StR<- filter_experiment_outcome_type(df, "TvC", "Stress response")
```

`r length(table(df_S$StudyId))` studies (`r nrow(df%>%filter(SortLabel == "TvC"))` comparisons) investigated the effects of exercise versus control. The number of studies and individual effect sizes for each outcome were:

-   Locomotor outcomes: `r length(table(df_S_L$StudyId))` studies and `r nrow(df_S_L)` comparisons in `r {strains <- unique(df_S_L$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Fear Memory `r length(table(df_S_FM$StudyId))` studies and `r nrow(df_S_FM)` comparisons in `r {strains <- unique(df_S_FM$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Freezing: `r length(table(df_S_Fr$StudyId))` studies and `r nrow(df_S_Fr)` comparisons in `r {strains <- unique(df_S_Fr$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Other behaviours: `r length(table(df_S_OB$StudyId))` studies and `r nrow(df_S_OB)` comparisons in `r {strains <- unique(df_S_OB$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   BDNF: `r length(table(df_S_B$StudyId))` studies and `r nrow(df_S_B)` comparisons in `r {strains <- unique(df_S_B$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Neurotransmitter levels: `r length(table(df_S_NT$StudyId))` studies and `r nrow(df_S_NT)` comparisons in `r {strains <- unique(df_S_NT$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Biochemical stress responses: `r length(table(df_S_StR$StudyId))` studies and `r nrow(df_S_StR)` comparisons in `r {strains <- unique(df_S_StR$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Other neurobiological outcomes: `r length(table(df_S_OthN$StudyId))` studies and `r nrow(df_S_OthN)` comparisons in `r {strains <- unique(df_S_OthN$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

## 2.1 Outcome 1: Locomotor activity

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_L <- run_SMD(df, "TvC", "Locomotor")
#TvC levels 4,4,2 so stop
```

Multilevel analysis is only performed if there are 5 levels or more for at least one of Strain, Study and Experiment, and that is not the case here. `r SMD_S_L[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_L[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_L[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_L[["SMD_ML"]]$data$Strain))` different animal strain(s). We provide a conventional random effects model to illustrate the data. No subgroup analysis is performed. We also now include these locomotor outcomes under the 'other behavioural' heading below.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
forest_metafor(SMD_S_L, "TvC", "Locomotor")
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
# since locomotor actvity no longer considered separately, edit df to 'other behavioural'
column_name <- 'outcome_type'
condition <- df$SortLabel == "TvC" & df$outcome_type == "Locomotor"
df[condition, column_name] <- 'Other behavioural'
```

## 2.2 Outcome 2: Fear memory

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_FM <- run_SMD(df, "TvC", "Fear memory")
#TvC levels 4-4-1
```

Multilevel analysis is only performed if there are 5 levels or more for at least one of Strain, Study and Experiment, and that is not the case here. `r SMD_S_FM[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_FM[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_FM[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_FM[["SMD_ML"]]$data$Strain))` different animal strain(s). We provide a conventional random effects model to illustrate the data. No subgroup analysis is performed. We also now include these fear memory outcomes under the 'other behavioural' heading below.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
forest_metafor(SMD_S_FM, "TvC", "Fear memory")
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
# since fear memory no longer considered separately, edit df to 'other behavioural'
column_name <- 'outcome_type'
condition <- df$SortLabel == "TvC" & df$outcome_type == "Fear memory"
df[condition, column_name] <- 'Other behavioural'
```

## 2.3 Outcome 3: Freezing

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_Fr <- run_SMD(df, "TvC", "Freezing")
# TvC levels 3-3-2
```

Multilevel analysis is only performed if there are 5 levels or more for at least one of Strain, Study and Experiment, and that is not the case here. `r SMD_S_Fr[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_Fr[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_Fr[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_Fr[["SMD_ML"]]$data$Strain))` different animal strain(s). We provide a conventional random effects model to illustrate the data. No subgroup analysis is performed. We also now include these Freezing outcomes under the 'other behavioural' heading below.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
forest_metafor(SMD_S_Fr, "TvC", "Freezing")
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
# since freezing no longer considered separately, edit df to 'other behavioural'
column_name <- 'outcome_type'
condition <- df$SortLabel == "TvC" & df$outcome_type == "Freezing"
df[condition, column_name] <- 'Other behavioural'
```

## 2.4 Outcome 4: Other behavioural outcomes

### 2.4.1 Risks of bias

Figure 2.4.1 shows the risk of bias summary for studies investigating the effect of exercise on other behavioural outcomes in animals. The risk of bias assessment was performed using the SyRCLE RoB tool.

**Figure 2.4.1**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=8}
SyRCLE_RoB_traffic(df, "TvC", "Other behavioural")
```

### 2.4.2 Reporting completeness

Figure 2.4.2 shows the reporting completeness summary for studies investigating the effect of exercise on other behavioural outcomes in animals. The reporting completeness assessment was performed using the ARRIVE guidelines.

**Figure 2.4.2**

```{r message = FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height = 10}
ARRIVE_traffic(df, "TvC", "Other behavioural")
```

### 2.4.3 Meta-analysis

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB <- run_ML_SMD(df, "TvC", "Other behavioural", 0.5)
```

The effect of exercise on other behavioural outcomes in animals using SMD as the effect size is shown in Figure 2.4.3. The pooled estimate for SMD across all individual comparisons is displayed as a diamond shape at the bottom of the plot. Dotted lines indicate the prediction interval of the pooled estimate.

**Figure 2.4.3**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=15}
forest_metafor(SMD_S_OB, "TvC", "other behavioural")
```

Exercise interventions had a pooled effect on other behavioural outcomes induced by single prolonged stress of SMD = `r round(SMD_S_OB$SMD_ML[['beta']], 3)`, (95% CI: `r round(SMD_S_OB$SMD_ML[['ci.lb']], 3)` to `r round(SMD_S_OB$SMD_ML[['ci.ub']], 3)`; 95% PrI: `r round(SMD_S_OB[["pred_interval"]][["pi.lb"]], 3)` to `r round(SMD_S_OB[["pred_interval"]][["pi.ub"]], 3)`).

`r SMD_S_OB$SMD_ML[["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_OB[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_OB[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_OB[["SMD_ML"]]$data$Strain))` different animal strain(s).

|            Level            |                                                               Number of categories for that level included in this analysis                                                                |                                                                                   Attributable variance                                                                                    |
|:---------------:|:--------------------------:|:--------------------------:|
|            Study            |                       `r ifelse('StudyId' %in% SMD_S_OB[["SMD_ML"]]$s.names, SMD_S_OB[["SMD_ML"]]$s.nlevels[[which(SMD_S_OB[["SMD_ML"]]$s.names == 'StudyId')]], 0)`                       |                       `r ifelse('StudyId' %in% SMD_S_OB[["SMD_ML"]]$s.names, SMD_S_OB[["SMD_ML"]]$sigma2[[which(SMD_S_OB[["SMD_ML"]]$s.names == 'StudyId')]], 'NA')`                       |
|     Study x Experiment      |        `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB[["SMD_ML"]]$s.names, SMD_S_OB[["SMD_ML"]]$s.nlevels[[which(SMD_S_OB[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 0)`        |        `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB[["SMD_ML"]]$s.names, SMD_S_OB[["SMD_ML"]]$sigma2[[which(SMD_S_OB[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 'NA')`        |

### 2.4.4 Subgroup analyses and meta-regressions

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen=100, digits=3)
```

For each outcome, the covariates of interest for subgroup analyses and meta-regressions were:

-   **Sex**
-   **Voluntary or forced exercise**
-   **Duration of exercise**
-   **Intensity of exercise**

We also conducted subgroup analyses using **(1) SyRCLE Risk of Bias** and **(2) ARRIVE reporting completeness** assessment scores as covariates to evaluate their influence on effect size estimates. These were not specified in the study protocol, but evaluation of risk of bias is required for the Summary of Evidence table, and no studies were considered entirely at low risk of bias or of high reporting completeness to allow such a sensitivity analysis.

The significance (p-value) reported is that for a test of whether the moderators are significantly different one from another, rather than whether the effect is significantly different from 0.

#### **Sex**

Figure 2.4.4.1 displays the estimates for the pooled SMD's when comparisons are stratified by sex of the animal. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by sex, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.4.4.1 - Effect of exercise on other behavioural outcomes by Sex**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_sex <- subgroup_analysis(df, "TvC", "Other behavioural", "Sex", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "Other behavioural", "Sex", SMD_S_OB_sex, SMD_S_OB)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_sex_noI <- subgroup_SMD(df, "TvC", "Other behavioural", "Sex", 0.5)
```

The p-value for the association between the sex of animal groups used and outcome reported was `r round(SMD_S_OB_sex_noI$QMp,3)`.

|       Level        |                                                          Number of categories for that level included in this analysis                                                          |                                                                              Attributable variance                                                                              |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OB_sex$analysis$s.names, SMD_S_OB_sex$analysis$s.nlevels[[which(SMD_S_OB_sex$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OB_sex$analysis$s.names, SMD_S_OB_sex$analysis$sigma2[[which(SMD_S_OB_sex$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_sex$analysis$s.names, SMD_S_OB_sex$analysis$s.nlevels[[which(SMD_S_OB_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_sex$analysis$s.names, SMD_S_OB_sex$analysis$sigma2[[which(SMD_S_OB_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **Voluntary or forced exercise**

Figure 2.4.4.2 displays the estimates for the pooled SMD when comparisons are stratified by whether the exercise was voluntary or forced (VoF). Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by exercise type, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.4.4.2 - Effect of exercise on other behavioural outcomes by voluntary or forced exercise**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_VoF <- subgroup_analysis(df, "TvC", "Other behavioural", "VoF", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "Other behavioural", "VoF", SMD_S_OB_VoF, SMD_S_OB)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_VoF_noI <- subgroup_SMD(df, "TvC", "Other behavioural", "VoF", 0.5)
```

The p-value for the association between the VoF of animal groups used and outcome reported was `r round(SMD_S_OB_VoF_noI$QMp,3)`.

|       Level        |                                                          Number of categories for that level included in this analysis                                                          |                                                                              Attributable variance                                                                              |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OB_VoF$analysis$s.names, SMD_S_OB_VoF$analysis$s.nlevels[[which(SMD_S_OB_VoF$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OB_VoF$analysis$s.names, SMD_S_OB_VoF$analysis$sigma2[[which(SMD_S_OB_VoF$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_VoF$analysis$s.names, SMD_S_OB_VoF$analysis$s.nlevels[[which(SMD_S_OB_VoF$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_VoF$analysis$s.names, SMD_S_OB_VoF$analysis$sigma2[[which(SMD_S_OB_VoF$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **Duration of treatment**

We provide a meta-regression of the number of weeks of treatment as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_DOE <- metaregression_analysis(df, "TvC", "Other behavioural", "DurationOfTreatmentWeeks1", 0.5)

```

**Figure 2.4.4.3 - Effect of exercise on other behavioural outcomes by Duration of treatment**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_OB_DOE$regression_plot
```

The p-value for the association between duration of treatment and outcome reported was `r round(SMD_S_OB_DOE$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                      Number of categories for that level included in this analysis                                                                                      |                                                                                                          Attributable variance                                                                                                          |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_OB_DOE$metaregression_summary$s.names, SMD_S_OB_DOE$metaregression_summary$s.nlevels[[which(SMD_S_OB_DOE$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_OB_DOE$metaregression_summary$s.names, SMD_S_OB_DOE$metaregression_summary$sigma2[[which(SMD_S_OB_DOE$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_OB_DOE$metaregression_summary$s.names, SMD_S_OB_DOE$metaregression_summary$s.nlevels[[which(SMD_S_OB_DOE$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_OB_DOE$metaregression_summary$s.names, SMD_S_OB_DOE$metaregression_summary$sigma2[[which(SMD_S_OB_DOE$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OB_DOE$metaregression_summary$s.names, SMD_S_OB_DOE$metaregression_summary$s.nlevels[[which(SMD_S_OB_DOE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OB_DOE$metaregression_summary$s.names, SMD_S_OB_DOE$metaregression_summary$sigma2[[which(SMD_S_OB_DOE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Exercise Intensity**

We provide a meta-regression where exercise intensity (expressed as m/min) is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_EI <- metaregression_analysis(df, "TvC", "Other behavioural", "EI1", 0.5)

```

**Figure 2.4.4.4 - Effect of exercise on other behavioural outcomes by exercise intensity**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_OB_EI$regression_plot
```

The p-value for the association between exercise intensity and the outcome reported was `r round(SMD_S_OB_EI$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                    Number of categories for that level included in this analysis                                                                                     |                                                                                                        Attributable variance                                                                                                         |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_OB_EI$metaregression_summary$s.names, SMD_S_OB_EI$metaregression_summary$s.nlevels[[which(SMD_S_OB_EI$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_OB_EI$metaregression_summary$s.names, SMD_S_OB_EI$metaregression_summary$sigma2[[which(SMD_S_OB_EI$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_OB_EI$metaregression_summary$s.names, SMD_S_OB_EI$metaregression_summary$s.nlevels[[which(SMD_S_OB_EI$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_OB_EI$metaregression_summary$s.names, SMD_S_OB_EI$metaregression_summary$sigma2[[which(SMD_S_OB_EI$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OB_EI$metaregression_summary$s.names, SMD_S_OB_EI$metaregression_summary$s.nlevels[[which(SMD_S_OB_EI$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OB_EI$metaregression_summary$s.names, SMD_S_OB_EI$metaregression_summary$sigma2[[which(SMD_S_OB_EI$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Total exercise**

We provide a meta-regression where the total exercise as the product of the number of sessions (n), session duration (min), and session intensity (km/min), with total exercise expressed in km (n \* min \* km/min), is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_TE <- metaregression_analysis1(df, "TvC", "Other behavioural", "TotalExercise1", 0.5)

```

**Figure 2.4.4.5**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_OB_TE$regression_plot
```

The p-value for the association between total exercise and the outcome reported was `r ifelse(SMD_S_OB_TE$metaregression_summary$pval[2] < 0.001, "<0.001", sprintf("%.3f", SMD_S_OB_TE$metaregression_summary$pval[2]))`.

|            Level            |                                                                                    Number of categories for that level included in this analysis                                                                                     |                                                                                                        Attributable variance                                                                                                         |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_OB_TE$metaregression_summary$s.names, SMD_S_OB_TE$metaregression_summary$s.nlevels[[which(SMD_S_OB_TE$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_OB_TE$metaregression_summary$s.names, SMD_S_OB_TE$metaregression_summary$sigma2[[which(SMD_S_OB_TE$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_OB_TE$metaregression_summary$s.names, SMD_S_OB_TE$metaregression_summary$s.nlevels[[which(SMD_S_OB_TE$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_OB_TE$metaregression_summary$s.names, SMD_S_OB_TE$metaregression_summary$sigma2[[which(SMD_S_OB_TE$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OB_TE$metaregression_summary$s.names, SMD_S_OB_TE$metaregression_summary$s.nlevels[[which(SMD_S_OB_TE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OB_TE$metaregression_summary$s.names, SMD_S_OB_TE$metaregression_summary$sigma2[[which(SMD_S_OB_TE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considered as a categorical variable**

Figure 2.4.4.6 displays the estimates for the pooled SMD when comparisons are stratified by how many of the SyRCLE risk of bias assessment criteria (of which there are 10) the experiment met. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by SyRCLE Risk of Bias, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.4.4.6 - Effect of exercise on other behavioural outcomes by SyRCLE** **risk of bias criteria**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_OB_SyRCLERoB <- subgroup_analysis(df, "TvC", "Other behavioural", "RoBScore", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "Other behavioural", "RoBScore", SMD_S_OB_SyRCLERoB, SMD_S_OB)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_SyRCLERoB_noI <- subgroup_SMD(df, "TvC", "Other behavioural", "RoBScore", 0.5)
```

The p-value for the association between SyRCLE Risks of Bias reporting and the outcome reported was `r round(SMD_S_OB_SyRCLERoB_noI$QMp,3)`.

|       Level        |                                                                   Number of categories for that level included in this analysis                                                                   |                                                                                       Attributable variance                                                                                       |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OB_SyRCLERoB$analysis$s.names, SMD_S_OB_SyRCLERoB$analysis$s.nlevels[[which(SMD_S_OB_SyRCLERoB$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OB_SyRCLERoB$analysis$s.names, SMD_S_OB_SyRCLERoB$analysis$sigma2[[which(SMD_S_OB_SyRCLERoB$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_SyRCLERoB$analysis$s.names, SMD_S_OB_SyRCLERoB$analysis$s.nlevels[[which(SMD_S_OB_SyRCLERoB$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_SyRCLERoB$analysis$s.names, SMD_S_OB_SyRCLERoB$analysis$sigma2[[which(SMD_S_OB_SyRCLERoB$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considering those studies where any item is at low risk of bias**

Figure 2.4.4.7 displays the estimates for the pooled SMD when comparisons are stratified by whether of not any of the SyRCLE Risk of bias domains were rated as low risk of bias. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by SyRCLE Risk of Bias, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.4.4.7 - Effect of exercise on other behavioural outcomes by low SyRCLE** **RoB**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_OB_SyRCLERoBTF <- subgroup_analysis(df, "TvC", "Other behavioural", "RoBTF", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "Other behavioural", "RoBTF", SMD_S_OB_SyRCLERoBTF, SMD_S_OB)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_SyRCLERoBTF_noI <- subgroup_SMD(df, "TvC", "Other behavioural", "RoBTF", 0.5)
```

The p-value for the association between low SyRCLE Risks of Bias reporting and the outcome reported was `r round(SMD_S_OB_SyRCLERoBTF_noI$QMp,3)`.

|       Level        |                                                                      Number of categories for that level included in this analysis                                                                      |                                                                                          Attributable variance                                                                                          |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OB_SyRCLERoBTF$analysis$s.names, SMD_S_OB_SyRCLERoBTF$analysis$s.nlevels[[which(SMD_S_OB_SyRCLERoBTF$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OB_SyRCLERoBTF$analysis$s.names, SMD_S_OB_SyRCLERoBTF$analysis$sigma2[[which(SMD_S_OB_SyRCLERoBTF$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_SyRCLERoBTF$analysis$s.names, SMD_S_OB_SyRCLERoBTF$analysis$s.nlevels[[which(SMD_S_OB_SyRCLERoBTF$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_SyRCLERoBTF$analysis$s.names, SMD_S_OB_SyRCLERoBTF$analysis$sigma2[[which(SMD_S_OB_SyRCLERoBTF$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **ARRIVE reporting completeness guidelines**

We provide a meta-regression where the number of ARRIVE items met is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_ARR2 <- metaregression_analysis(df, "TvC", "Other behavioural", "ARRIVEScore", 0.5)

```

**Figure 2.4.4.8 - Effect of exercise on other behavioural outcomes by ARRIVE reporting completeness**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_OB_ARR2$regression_plot
```

The p-value for the association between ARRIVE reporting completeness and outcome reported was `r round(SMD_S_OB_ARR2$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                       Number of categories for that level included in this analysis                                                                                        |                                                                                                           Attributable variance                                                                                                            |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$sigma2[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$sigma2[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$sigma2[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Heterogeneity explained by covariates (Effect of exercise on other behaviours)**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_OB_sexI <- subgroup_SMDI(df, "TvC", "Other behavioural", "Sex", 0.5)
SMD_S_OB_VoFI <- subgroup_SMDI(df, "TvC", "Other behavioural", "VoF", 0.5)
SMD_S_OB_SyRCLERoBI <- subgroup_SMDI(df, "TvC", "Other behavioural", "RoBScore", 0.5)
```

The table below shows which of the covariates, if any, explain some of the heterogeneity observed in the effect of exercise on other behaviours. We present marginal R^2^, which measures the proportion of variance explained by including moderators in the model (the % change in the between-studies variance when the covariate is included in the model, in other words the % of the heterogeneity explained by the variable). The coefficients are derived form an RMA model fitted with an intercept (and so represent, for each category, the point estimate and 95% CIs of the effect in that category).

|       Moderator        |             Category              |                     $\beta$                      |                                                 95% CI                                                 |                     Marginal R^2^ (%)                      |
|:------------:|:------------:|:------------:|:---------------:|:------------:|
|     Overall effect     |                \-                 |         `r SMD_S_OB[["SMD_ML"]]$beta[1]`         |                    `r SMD_S_OB[["SMD_ML"]]$ci.lb` to `r SMD_S_OB[["SMD_ML"]]$ci.ub`                    |                             \-                             |
|          Sex           |                \-                 |                        \-                        |                                                   \-                                                   |        `r round((r2_ml(SMD_S_OB_sexI)[1]*100),1)`%         |
|           \-           |             *Female*              |            `r SMD_S_OB_sexI$beta[1]`             |                        `r SMD_S_OB_sexI$ci.lb[1]` to `r SMD_S_OB_sexI$ci.ub[1]`                        |                             \-                             |
|           \-           |              *Male*               |            `r SMD_S_OB_sexI$beta[2]`             |                        `r SMD_S_OB_sexI$ci.lb[2]` to `r SMD_S_OB_sexI$ci.ub[2]`                        |                             \-                             |
|  Voluntary or forced   |                \-                 |                        \-                        |                                                   \-                                                   |        `r round((r2_ml(SMD_S_OB_VoFI)[1]*100),1)`%         |
|           \-           |             *Forced*              |            `r SMD_S_OB_VoFI$beta[1]`             |                        `r SMD_S_OB_VoFI$ci.lb[1]` to `r SMD_S_OB_VoFI$ci.ub[1]`                        |                             \-                             |
|           \-           |            *Voluntary*            |            `r SMD_S_OB_VoFI$beta[2]`             |                        `r SMD_S_OB_VoFI$ci.lb[2]` to `r SMD_S_OB_VoFI$ci.ub[2]`                        |                             \-                             |
| Duration of treatment  |                \-                 |                        \-                        |                                                   \-                                                   | `r round((r2_ml(SMD_S_OB_DOE$metaregression)[1]*100),1)`%  |
|           \-           | *per weeks of treatment increase* | `r SMD_S_OB_DOE$metaregression_summary$beta[2]`  |  `r SMD_S_OB_DOE$metaregression_summary$ci.lb[2]` to `r SMD_S_OB_DOE$metaregression_summary$ci.ub[2]`  |                             \-                             |
|   Exercise intensity   |                \-                 |                        \-                        |                                                   \-                                                   |  `r round((r2_ml(SMD_S_OB_EI$metaregression)[1]*100),1)`%  |
|           \-           |    *per unit (m/min) increase*    |  `r SMD_S_OB_EI$metaregression_summary$beta[2]`  |   `r SMD_S_OB_EI$metaregression_summary$ci.lb[2]` to `r SMD_S_OB_EI$metaregression_summary$ci.ub[2]`   |                             \-                             |
|     Total exercise     |                \-                 |                        \-                        |                                                   \-                                                   |  `r round((r2_ml(SMD_S_OB_TE$metaregression)[1]*100),1)`%  |
|           \-           |         *per km increase*         |  `r SMD_S_OB_TE$metaregression_summary$beta[2]`  |   `r SMD_S_OB_TE$metaregression_summary$ci.lb[2]` to `r SMD_S_OB_TE$metaregression_summary$ci.ub[2]`   |                             \-                             |
|      Risk of Bias      |                \-                 |                        \-                        |                                                   \-                                                   |     `r round((r2_ml(SMD_S_OB_SyRCLERoBI)[1]*100),1)`%      |
|           \-           |         *0 criteria met*          |         `r SMD_S_OB_SyRCLERoBI$beta[1]`          |                  `r SMD_S_OB_SyRCLERoBI$ci.lb[1]` to `r SMD_S_OB_SyRCLERoBI$ci.ub[1]`                  |                             \-                             |
|           \-           |         *1 criteria met*          |         `r SMD_S_OB_SyRCLERoBI$beta[2]`          |                  `r SMD_S_OB_SyRCLERoBI$ci.lb[2]` to `r SMD_S_OB_SyRCLERoBI$ci.ub[2]`                  |                             \-                             |
| Reporting completeness |                \-                 |                        \-                        |                                                   \-                                                   | `r round((r2_ml(SMD_S_OB_ARR2$metaregression)[1]*100),1)`% |
|           \-           |        *per unit increase*        | `r SMD_S_OB_ARR2$metaregression_summary$beta[2]` | `r SMD_S_OB_ARR2$metaregression_summary$ci.lb[2]` to `r SMD_S_OB_ARR2$metaregression_summary$ci.ub[2]` |                             \-                             |

### 2.4.5 Sensitivity Analyses

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen = 100, digits = 2)
```

We examine the robustness of the findings for other behaviours by performing the following sensitivity analyses.

#### Imputed rho values of 0.2 and 0.8

In the previous analyses for the effect of exercise on other behavioural outcomes, we imputed a $\rho$ value - the imputed within-study correlation between observed effect sizes - of 0.5. Here, we examine the effect of imputing $\rho$ values of 0.2 and 0.8.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_rho0.2 <- run_ML_SMD(df, "TvC", "Other behavioural", 0.2)
```

When the $\rho$ value is assumed to be 0.2, exercise had a pooled effect on other behavioural outcomes of **SMD = `r round(SMD_S_OB_rho0.2[["SMD_ML"]][["beta"]],3)`** (95% CI: `r round(SMD_S_OB_rho0.2[["SMD_ML"]][["ci.lb"]],3)` to `r round(SMD_S_OB_rho0.2[["SMD_ML"]][["ci.ub"]],3)`; 95% PrI: `r round(SMD_S_OB_rho0.2[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_OB_rho0.2[["pred_interval"]][["pi.ub"]],3)`).

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_rho0.8 <- run_ML_SMD(df, "TvC", "Other behavioural", 0.8)
```

When the $\rho$ value is assumed to be 0.8, exercise had a pooled effect on other behavioural outcomes of **SMD = `r SMD_S_OB_rho0.8[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_OB_rho0.8[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_OB_rho0.8[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_OB_rho0.8[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_OB_rho0.8[["pred_interval"]][["pi.ub"]],3)`).

For reference the pooled effect size when rho is assumed to be 0.5 is `r SMD_S_OB[["SMD_ML"]][["beta"]]` (95% CI: `r SMD_S_OB[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_OB[["SMD_ML"]][["ci.ub"]]`).

### 2.4.6 Reporting bias/small-study effects

Because of the relationship between SMD effect sizes and variance inherent in their calculation, where study size is small the standard approach to seeking evidence of small-study effects (regression based tests including Egger's regression test for multilevel meta-analysis) can lead to over-estimation of small-study effect (see for instance [10.7554/eLife.24260](10.7554/eLife.24260)). To address this we used Egger's regression test for multilevel meta-analysis, with regression of SMD effect size against 1/√N, where N is the total number of animals involved in an experiment.

```{r warning=FALSE, eval = TRUE, echo = FALSE}
run_sse_plot_SMD_L(df, 'TvC', 'Other behavioural')
#run_sse_NMD(df)
```

Egger regression based on `r run_sse_SMD_L(df, 'TvC', 'Other behavioural')[["k"]]` studies of modelling of depression where sucrose preference was measured showed a coefficient for a small-study effect of `r run_sse_SMD_L(df, 'TvC', 'Other behavioural')[["beta"]][2]` (95% CI: `r run_sse_SMD_L(df, 'TvC', 'Other behavioural')[["ci.lb"]][2]` to `r run_sse_SMD_L(df, 'TvC', 'Other behavioural')[["ci.ub"]][2]`; p = `r ifelse(run_sse_SMD_L(df, 'TvC', 'Other behavioural')[["pval"]][2] < 0.001, "<0.001", sprintf("%.3f", run_sse_SMD_L(df, 'TvC', 'Other behavioural')[["pval"]][2]))`).

## 2.5 Outcome 5: BDNF

### 2.5.1 Risks of bias

Figure 2.5.1 shows the risk of bias summary for studies investigating the effect of exercise on BDNF in animals. The risk of bias assessment was performed using the SyRCLE RoB tool.

**Figure 2.5.1**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
SyRCLE_RoB_traffic(df, "TvC", "BDNF")
```

### 2.5.2 Reporting completeness

Figure 2.5.2 shows the reporting completeness summary for studies investigating the effect of exercise on BDNF in animals. The reporting completeness assessment was performed using the ARRIVE guidelines.

**Figure 2.5.2**

```{r message = FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=8}
ARRIVE_traffic(df, "TvC", "BDNF")
```

### 2.5.3 Meta-analysis

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B <- run_ML_SMD(df, "TvC", "BDNF", 0.5)
```

The effect of exercise on BDNF in animals using SMD as the effect size is shown in Figure 2.5.3. The pooled estimate for SMD across all individual comparisons is displayed as a diamond shape at the bottom of the plot. Dotted lines indicate the prediction interval of the pooled estimate.

**Figure 2.5.3**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=8}
forest_metafor(SMD_S_B, "TvC", "BDNF")
```

Exercise had a pooled effect on BDNF of SMD = `r round(SMD_S_B[["SMD_ML"]][['beta']], 3)` , (95% CI: `r round(SMD_S_B[["SMD_ML"]][['ci.lb']], 3)` to `r round(SMD_S_B[["SMD_ML"]][['ci.ub']], 3)`; 95% PrI: `r round(SMD_S_B[["pred_interval"]][["pi.lb"]], 3)` to `r round(SMD_S_B[["pred_interval"]][["pi.ub"]], 3)`).

`r SMD_S_B[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_B[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_B[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_B[["SMD_ML"]]$data$Strain))` different animal strain(s).

|       Level        |                                                       Number of categories for that level included in this analysis                                                       |                                                                           Attributable variance                                                                           |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_B[["SMD_ML"]]$s.names, SMD_S_B[["SMD_ML"]]$s.nlevels[[which(SMD_S_B[["SMD_ML"]]$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_B[["SMD_ML"]]$s.names, SMD_S_B[["SMD_ML"]]$sigma2[[which(SMD_S_B[["SMD_ML"]]$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_B[["SMD_ML"]]$s.names, SMD_S_B[["SMD_ML"]]$s.nlevels[[which(SMD_S_B[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_B[["SMD_ML"]]$s.names, SMD_S_B[["SMD_ML"]]$sigma2[[which(SMD_S_B[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

### 2.5.4 Subgroup analyses and meta-regressions

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen=100, digits=3)
```

For each outcome, the covariates of interest for subgroup analyses and meta-regressions were:

-   **Sex**
-   **Voluntary or forced exercise**
-   **Duration of exercise**
-   **Intensity of exercise**

We also conducted subgroup analyses using **(1) SyRCLE Risk of Bias** and **(2) ARRIVE reporting completeness** assessment scores as covariates to evaluate their influence on effect size estimates. These were not specified in the study protocol, but evaluation of risk of bias is required for the Summary of Evidence table, and no studies were considered entirely at low risk of bias or of high reporting completeness to allow such a sensitivity analysis.

The significance (p-value) reported is that for a test of whether the moderators are significantly different one from another, rather than whether the effect is significantly different from 0.

#### **Sex**

Figure 2.5.4.1 displays the estimates for the pooled SMD when comparisons are stratified by sex of the animal. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by sex, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.5.4.1 - Effect of exercise on BDNF by Sex**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_sex <- subgroup_analysis(df, "TvC", "BDNF", "Sex", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "BDNF", "Sex", SMD_S_B_sex, SMD_S_B)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_sex_noI <- subgroup_SMD(df, "TvC", "BDNF", "Sex", 0.5)
```

The p-value for the association between the sex of animal groups used and outcome reported was `r round(SMD_S_B_sex_noI$QMp,3)`.

|       Level        |                                                        Number of categories for that level included in this analysis                                                         |                                                                            Attributable variance                                                                             |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_B_sex$analysis$s.names, SMD_S_B_sex$analysis$s.nlevels[[which(SMD_S_B_sex$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_B_sex$analysis$s.names, SMD_S_B_sex$analysis$sigma2[[which(SMD_S_B_sex$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_B_sex$analysis$s.names, SMD_S_B_sex$analysis$s.nlevels[[which(SMD_S_B_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_B_sex$analysis$s.names, SMD_S_B_sex$analysis$sigma2[[which(SMD_S_B_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **Voluntary or forced exercise**

Figure 2.5.4.2 displays the estimates for the pooled SMD when comparisons are stratified by whether the exercise was voluntary or forced (VoF). Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by exercise type, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.5.4.2 - Effect of exercise on other BDNF by voluntary or forced exercise**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_VoF <- subgroup_analysis(df, "TvC", "BDNF", "VoF", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "BDNF", "VoF", SMD_S_B_VoF, SMD_S_B)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_VoF_noI <- subgroup_SMD(df, "TvC", "BDNF", "VoF", 0.5)
```

The p-value for the association between the VoF of animal groups used and outcome reported was `r round(SMD_S_B_VoF_noI$QMp,3)`.

|       Level        |                                                        Number of categories for that level included in this analysis                                                         |                                                                            Attributable variance                                                                             |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_B_VoF$analysis$s.names, SMD_S_B_VoF$analysis$s.nlevels[[which(SMD_S_B_VoF$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_B_VoF$analysis$s.names, SMD_S_B_VoF$analysis$sigma2[[which(SMD_S_B_VoF$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_B_VoF$analysis$s.names, SMD_S_B_VoF$analysis$s.nlevels[[which(SMD_S_B_VoF$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_B_VoF$analysis$s.names, SMD_S_B_VoF$analysis$sigma2[[which(SMD_S_B_VoF$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **Duration of treatment**

We provide a meta-regression of the number of weeks of treatment as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_DOE <- metaregression_analysis(df, "TvC", "BDNF", "DurationOfTreatmentWeeks1", 0.5)

```

**Figure 2.5.4.3 - Effect of exercise on BDNF by duration of treatment**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_B_DOE$regression_plot
```

The p-value for the association between duration of treatment and outcome reported was `r round(SMD_S_B_DOE$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                    Number of categories for that level included in this analysis                                                                                     |                                                                                                        Attributable variance                                                                                                         |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_B_DOE$metaregression_summary$s.names, SMD_S_B_DOE$metaregression_summary$s.nlevels[[which(SMD_S_B_DOE$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_B_DOE$metaregression_summary$s.names, SMD_S_B_DOE$metaregression_summary$sigma2[[which(SMD_S_B_DOE$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_B_DOE$metaregression_summary$s.names, SMD_S_B_DOE$metaregression_summary$s.nlevels[[which(SMD_S_B_DOE$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_B_DOE$metaregression_summary$s.names, SMD_S_B_DOE$metaregression_summary$sigma2[[which(SMD_S_B_DOE$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_B_DOE$metaregression_summary$s.names, SMD_S_B_DOE$metaregression_summary$s.nlevels[[which(SMD_S_B_DOE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_B_DOE$metaregression_summary$s.names, SMD_S_B_DOE$metaregression_summary$sigma2[[which(SMD_S_B_DOE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Exercise Intensity**

We provide a meta-regression where exercise intensity (expressed at m/min) is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_EI <- metaregression_analysis(df, "TvC", "BDNF", "EI1", 0.5)

```

**Figure 2.5.4.4 - Effect of exercise on BDNF by exercise intensity**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_B_EI$regression_plot
```

The p-value for the association between exercise intensity and outcome reported was `r round(SMD_S_B_EI$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                   Number of categories for that level included in this analysis                                                                                   |                                                                                                       Attributable variance                                                                                                       |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_B_EI$metaregression_summary$s.names, SMD_S_B_EI$metaregression_summary$s.nlevels[[which(SMD_S_B_EI$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_B_EI$metaregression_summary$s.names, SMD_S_B_EI$metaregression_summary$sigma2[[which(SMD_S_B_EI$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_B_EI$metaregression_summary$s.names, SMD_S_B_EI$metaregression_summary$s.nlevels[[which(SMD_S_B_EI$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_B_EI$metaregression_summary$s.names, SMD_S_B_EI$metaregression_summary$sigma2[[which(SMD_S_B_EI$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_B_EI$metaregression_summary$s.names, SMD_S_B_EI$metaregression_summary$s.nlevels[[which(SMD_S_B_EI$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_B_EI$metaregression_summary$s.names, SMD_S_B_EI$metaregression_summary$sigma2[[which(SMD_S_B_EI$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Total exercise**

We provide a meta-regression where the total exercise as the product of the number of sessions, session duration, and session intensity, expressed in km, is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_TE <- metaregression_analysis1(df, "TvC", "BDNF", "TotalExercise1", 0.5)

```

**Figure 2.5.4.5 - Effect of exercise on BDNF by total exercise**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_B_TE$regression_plot
```

The p-value for the association between total exercise and outcome reported was `r ifelse(SMD_S_B_TE$metaregression_summary$pval[2] < 0.001, "<0.001", sprintf("%.3f", SMD_S_B_TE$metaregression_summary$pval[2]))`.

|            Level            |                                                                                   Number of categories for that level included in this analysis                                                                                   |                                                                                                       Attributable variance                                                                                                       |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_B_TE$metaregression_summary$s.names, SMD_S_B_TE$metaregression_summary$s.nlevels[[which(SMD_S_B_TE$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_B_TE$metaregression_summary$s.names, SMD_S_B_TE$metaregression_summary$sigma2[[which(SMD_S_B_TE$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_B_TE$metaregression_summary$s.names, SMD_S_B_TE$metaregression_summary$s.nlevels[[which(SMD_S_B_TE$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_B_TE$metaregression_summary$s.names, SMD_S_B_TE$metaregression_summary$sigma2[[which(SMD_S_B_TE$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_B_TE$metaregression_summary$s.names, SMD_S_B_TE$metaregression_summary$s.nlevels[[which(SMD_S_B_TE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_B_TE$metaregression_summary$s.names, SMD_S_B_TE$metaregression_summary$sigma2[[which(SMD_S_B_TE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considered as a categorical variable**

No studies met any RoB criteria.

#### **SyRCLE RoB assessment considering those studies where any item is at low risk of bias**

No studies met any RoB criteria.

#### **ARRIVE reporting completeness guidelines**

We provide a meta-regression where the number of ARRIVE items met is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_ARR2 <- metaregression_analysis(df, "TvC", "BDNF", "ARRIVEScore", 0.5)

```

**Figure 2.5.4.6 - Effect of exercise on BDNF by ARRIVE reporting completeness**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_B_ARR2$regression_plot
```

The p-value for the association between ARRIVE reporting completeness and outcome reported was `r round(SMD_S_B_ARR2$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                      Number of categories for that level included in this analysis                                                                                      |                                                                                                          Attributable variance                                                                                                          |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$sigma2[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$sigma2[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$sigma2[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Heterogeneity explained by covariates (Effect of exercise on BDNF)**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_B_sexI <- subgroup_SMDI(df, "TvC", "BDNF", "Sex", 0.5)
SMD_S_B_VoFI <- subgroup_SMDI(df, "TvC", "BDNF", "VoF", 0.5)
SMD_S_B_ARRIVEI <- subgroup_SMDI(df, "TvC", "BDNF", "ARRIVEScoreCat", 0.5)
```

The table below shows which of the covariates, if any, explain some of the heterogeneity observed in the effect of exercise on BDNF. We present marginal R^2^, which measures the proportion of variance explained by including moderators in the model (the % change in the between-studies variance when the covariate is included in the model, in other words the % of the heterogeneity explained by the variable). The coefficients are derived form an RMA model fitted with an intercept (and so represent, for each category, the point estimate and 95% CIs of the effect in that category).

|       Moderator        |             Category              |                     $\beta$                     |                                                95% CI                                                |                     Marginal R^2^ (%)                     |
|:------------:|:------------:|:------------:|:---------------:|:------------:|
|     Overall effect     |                \-                 |         `r SMD_S_B[["SMD_ML"]]$beta[1]`         |                    `r SMD_S_B[["SMD_ML"]]$ci.lb` to `r SMD_S_B[["SMD_ML"]]$ci.ub`                    |                            \-                             |
|          Sex           |                \-                 |                       \-                        |                                                  \-                                                  |        `r round((r2_ml(SMD_S_B_sexI)[1]*100),1)`%         |
|           \-           |             *Female*              |            `r SMD_S_B_sexI$beta[1]`             |                        `r SMD_S_B_sexI$ci.lb[1]` to `r SMD_S_B_sexI$ci.ub[1]`                        |                            \-                             |
|           \-           |              *Male*               |            `r SMD_S_B_sexI$beta[2]`             |                        `r SMD_S_B_sexI$ci.lb[2]` to `r SMD_S_B_sexI$ci.ub[2]`                        |                            \-                             |
|  Voluntary or forced   |                \-                 |                       \-                        |                                                  \-                                                  |        `r round((r2_ml(SMD_S_B_VoFI)[1]*100),1)`%         |
|           \-           |             *Forced*              |            `r SMD_S_B_VoFI$beta[1]`             |                        `r SMD_S_B_VoFI$ci.lb[1]` to `r SMD_S_B_VoFI$ci.ub[1]`                        |                            \-                             |
|           \-           |            *Voluntary*            |            `r SMD_S_B_VoFI$beta[2]`             |                        `r SMD_S_B_VoFI$ci.lb[2]` to `r SMD_S_B_VoFI$ci.ub[2]`                        |                            \-                             |
| Duration of treatment  |                \-                 |                       \-                        |                                                  \-                                                  | `r round((r2_ml(SMD_S_B_DOE$metaregression)[1]*100),1)`%  |
|           \-           | *per weeks of treatment increase* | `r SMD_S_B_DOE$metaregression_summary$beta[2]`  |  `r SMD_S_B_DOE$metaregression_summary$ci.lb[2]` to `r SMD_S_B_DOE$metaregression_summary$ci.ub[2]`  |                            \-                             |
|   Exercise intensity   |                \-                 |                       \-                        |                                                  \-                                                  |  `r round((r2_ml(SMD_S_B_EI$metaregression)[1]*100),1)`%  |
|           \-           |    *per unit (m/min) increase*    |  `r SMD_S_B_EI$metaregression_summary$beta[2]`  |   `r SMD_S_B_EI$metaregression_summary$ci.lb[2]` to `r SMD_S_B_EI$metaregression_summary$ci.ub[2]`   |                            \-                             |
|     Total exercise     |                \-                 |                       \-                        |                                                  \-                                                  |  `r round((r2_ml(SMD_S_B_TE$metaregression)[1]*100),1)`%  |
|           \-           |         *per km increase*         |  `r SMD_S_B_TE$metaregression_summary$beta[2]`  |   `r SMD_S_B_TE$metaregression_summary$ci.lb[2]` to `r SMD_S_B_TE$metaregression_summary$ci.ub[2]`   |                            \-                             |
| Reporting completeness |                \-                 |                       \-                        |                                                  \-                                                  | `r round((r2_ml(SMD_S_B_ARR2$metaregression)[1]*100),1)`% |
|           \-           |        *per unit increase*        | `r SMD_S_B_ARR2$metaregression_summary$beta[2]` | `r SMD_S_B_ARR2$metaregression_summary$ci.lb[2]` to `r SMD_S_B_ARR2$metaregression_summary$ci.ub[2]` |                            \-                             |

### 2.5.5 Sensitivity Analyses

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen = 100, digits = 2)
```

We examine the robustness of the findings for BDNF by performing the following sensitivity analyses.

#### Imputed rho values of 0.2 and 0.8

In the previous analyses for the effect of exercise on BDNF, we imputed a $\rho$ value - the imputed within-study correlation between observed effect sizes - of 0.5. Here, we examine the effect of imputing $\rho$ values of 0.2 and 0.8.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_rho0.2 <- run_ML_SMD(df, "TvC", "BDNF", 0.2)
```

When the $\rho$ value is assumed to be 0.2, exercise had a pooled effect on BDNF of **SMD = `r round(SMD_S_B_rho0.2[["SMD_ML"]][["beta"]],3)`** (95% CI: `r round(SMD_S_B_rho0.2[["SMD_ML"]][["ci.lb"]],3)` to `r round(SMD_S_B_rho0.2[["SMD_ML"]][["ci.ub"]],3)`; 95% PrI: `r round(SMD_S_B_rho0.2[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_B_rho0.2[["pred_interval"]][["pi.ub"]],3)`).

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_rho0.8 <- run_ML_SMD(df, "TvC", "BDNF", 0.8)
```

When the $\rho$ value is assumed to be 0.8, exercise had a pooled effect on BDNF of **SMD = `r SMD_S_B_rho0.8[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_B_rho0.8[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_B_rho0.8[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_B_rho0.8[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_B_rho0.8[["pred_interval"]][["pi.ub"]],3)`).

For reference the pooled effect size when rho is assumed to be 0.5 is `r SMD_S_B[["SMD_ML"]][["beta"]]` (95% CI: `r SMD_S_B[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_B[["SMD_ML"]][["ci.ub"]]`).

### 2.5.6 Reporting bias/small-study effects

Because of the relationship between SMD effect sizes and variance inherent in their calculation, where study size is small the standard approach to seeking evidence of small-study effects (regression based tests including Egger's regression test for multilevel meta-analysis) can lead to over-estimation of small-study effect (see for instance [10.7554/eLife.24260](10.7554/eLife.24260)). To address this we used Egger's regression test for multilevel meta-analysis, with regression of SMD effect size against 1/√N, where N is the total number of animals involved in an experiment.

```{r warning=FALSE, eval = TRUE, echo = FALSE}
run_sse_plot_SMD_L(df, 'TvC', 'BDNF')
#run_sse_NMD(df)
```

Egger regression based on `r run_sse_SMD_L(df, 'TvC', 'BDNF')[["k"]]` studies of modelling of depression where sucrose preference was measured showed a coefficient for a small-study effect of `r run_sse_SMD_L(df, 'TvC', 'BDNF')[["beta"]][2]` (95% CI: `r run_sse_SMD_L(df, 'TvC', 'BDNF')[["ci.lb"]][2]` to `r run_sse_SMD_L(df, 'TvC', 'BDNF')[["ci.ub"]][2]`; p = `r ifelse(run_sse_SMD_L(df, 'TvC', 'BDNF')[["pval"]][2] < 0.001, "<0.001", sprintf("%.3f", run_sse_SMD_L(df, 'TvC', 'BDNF')[["pval"]][2]))`).

## 2.6 Outcome 6: Biological stress response

### 2.6.1 Risks of bias

Figure 2.6.1 shows the risk of bias summary for studies investigating the effect of exercise on biological stress response in animals. The risk of bias assessment was performed using the SyRCLE RoB tool.

**Figure 2.6.1**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
SyRCLE_RoB_traffic(df, "TvC", "Stress response")
```

### 2.6.2 Reporting completeness

Figure 2.6.2 shows the reporting completeness summary for studies investigating the effect of exercise on biological stress response in animals. The reporting completeness assessment was performed using the ARRIVE guidelines.

**Figure 2.6.2**

```{r message = FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=8}
ARRIVE_traffic(df, "TvC", "Stress response")
```

### 2.6.3 Meta-analysis

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR <- run_ML_SMD(df, "TvC", "Stress response", 0.5)
```

The effect of exercise on biological stress response in animals using SMD as the effect size is shown in Figure 2.6.3. The pooled estimate for SMD across all individual comparisons is displayed as a diamond shape at the bottom of the plot. Dotted lines indicate the prediction interval of the pooled estimate.

**Figure 2.6.3**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
forest_metafor(SMD_S_StR, "TvC", "Stress response")
```

Exercise interventions had a pooled effect on biological stress response induced by single prolonged stress of SMD = `r round(SMD_S_StR[["SMD_ML"]][['beta']], 3)`, (95% CI: `r round(SMD_S_StR[["SMD_ML"]][['ci.lb']], 3)` to `r round(SMD_S_StR[["SMD_ML"]][['ci.ub']], 3)`; 95% PrI: `r round(SMD_S_StR[["pred_interval"]][["pi.lb"]], 3)` to `r round(SMD_S_StR[["pred_interval"]][["pi.ub"]], 3)`).

`r SMD_S_StR[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_StR[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_StR[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_StR[["SMD_ML"]]$data$Strain))` different animal strain(s).

|       Level        |                                                          Number of categories for that level included in this analysis                                                          |                                                                              Attributable variance                                                                              |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_StR[["SMD_ML"]]$s.names, SMD_S_StR[["SMD_ML"]]$s.nlevels[[which(SMD_S_StR[["SMD_ML"]]$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_StR[["SMD_ML"]]$s.names, SMD_S_StR[["SMD_ML"]]$sigma2[[which(SMD_S_StR[["SMD_ML"]]$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR[["SMD_ML"]]$s.names, SMD_S_StR[["SMD_ML"]]$s.nlevels[[which(SMD_S_StR[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR[["SMD_ML"]]$s.names, SMD_S_StR[["SMD_ML"]]$sigma2[[which(SMD_S_StR[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

### 2.6.4 Subgroup analyses and meta-regressions

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen=100, digits=3)
```

For each outcome, the covariates of interest for subgroup analyses and meta-regressions were:

-   **Sex**
-   **Voluntary or forced exercise**
-   **Duration of exercise**
-   **Intensity of exercise**

We also conducted subgroup analyses using **(1) SyRCLE Risk of Bias** and **(2) ARRIVE reporting completeness** assessment scores as covariates to evaluate their influence on effect size estimates. These were not specified in the study protocol, but evaluation of risk of bias is required for the Summary of Evidence table, and no studies were considered entirely at low risk of bias or of high reporting completeness to allow such a sensitivity analysis.

The significance (p-value) reported is that for a test of whether the moderators are significantly different one from another, rather than whether the effect is significantly different from 0.

#### **Sex**

Figure 2.6.4.1 displays the estimates for the pooled SMD when comparisons are stratified by sex of the animal. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by sex, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.6.4.1 - Effect of exercise on biological stress response by Sex**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_sex <- subgroup_analysis(df, "TvC", "Stress response", "Sex", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "Stress response", "Sex", SMD_S_StR_sex, SMD_S_StR)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_sex_noI <- subgroup_SMD(df, "TvC", "Stress response", "Sex", 0.5)
```

The p-value for the association between the sex of animal groups used and biological stress response was `r round(SMD_S_StR_sex_noI$QMp,3)`.

|       Level        |                                                           Number of categories for that level included in this analysis                                                            |                                                                               Attributable variance                                                                                |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_StR_sex$analysis$s.names, SMD_S_StR_sex$analysis$s.nlevels[[which(SMD_S_StR_sex$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_StR_sex$analysis$s.names, SMD_S_StR_sex$analysis$sigma2[[which(SMD_S_StR_sex$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_sex$analysis$s.names, SMD_S_StR_sex$analysis$s.nlevels[[which(SMD_S_StR_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_sex$analysis$s.names, SMD_S_StR_sex$analysis$sigma2[[which(SMD_S_StR_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **Voluntary or forced exercise**

All studies used forced exercise.

#### **Duration of treatment**

We provide a meta-regression of the number of weeks of treatment as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_DOE <- metaregression_analysis(df, "TvC", "Stress response", "DurationOfTreatmentWeeks1", 0.5)

```

**Figure 2.6.4.2 - Effect of exercise on biological stress response by duration of treatment**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_StR_DOE$regression_plot
```

The p-value for the association between duration of treatment and biological stress response was `r round(SMD_S_StR_DOE$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                       Number of categories for that level included in this analysis                                                                                        |                                                                                                           Attributable variance                                                                                                            |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_StR_DOE$metaregression_summary$s.names, SMD_S_StR_DOE$metaregression_summary$s.nlevels[[which(SMD_S_StR_DOE$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_StR_DOE$metaregression_summary$s.names, SMD_S_StR_DOE$metaregression_summary$sigma2[[which(SMD_S_StR_DOE$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_StR_DOE$metaregression_summary$s.names, SMD_S_StR_DOE$metaregression_summary$s.nlevels[[which(SMD_S_StR_DOE$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_StR_DOE$metaregression_summary$s.names, SMD_S_StR_DOE$metaregression_summary$sigma2[[which(SMD_S_StR_DOE$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_StR_DOE$metaregression_summary$s.names, SMD_S_StR_DOE$metaregression_summary$s.nlevels[[which(SMD_S_StR_DOE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_StR_DOE$metaregression_summary$s.names, SMD_S_StR_DOE$metaregression_summary$sigma2[[which(SMD_S_StR_DOE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Exercise Intensity**

We provide a meta-regression where exercise intensity is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_EI <- metaregression_analysis(df, "TvC", "Stress response", "EI1", 0.5)

```

**Figure 2.6.4.3 - Effect of exercise on biological stress response by exercise intensity**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_StR_EI$regression_plot
```

The p-value for the association between exercise intensity and biological stress response was `r round(SMD_S_StR_EI$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                      Number of categories for that level included in this analysis                                                                                      |                                                                                                          Attributable variance                                                                                                          |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_StR_EI$metaregression_summary$s.names, SMD_S_StR_EI$metaregression_summary$s.nlevels[[which(SMD_S_StR_EI$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_StR_EI$metaregression_summary$s.names, SMD_S_StR_EI$metaregression_summary$sigma2[[which(SMD_S_StR_EI$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_StR_EI$metaregression_summary$s.names, SMD_S_StR_EI$metaregression_summary$s.nlevels[[which(SMD_S_StR_EI$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_StR_EI$metaregression_summary$s.names, SMD_S_StR_EI$metaregression_summary$sigma2[[which(SMD_S_StR_EI$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_StR_EI$metaregression_summary$s.names, SMD_S_StR_EI$metaregression_summary$s.nlevels[[which(SMD_S_StR_EI$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_StR_EI$metaregression_summary$s.names, SMD_S_StR_EI$metaregression_summary$sigma2[[which(SMD_S_StR_EI$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Total exercise**

We provide a meta-regression where the total exercise as the product of the number of sessions, session duration, and session intensity, expressed in km, is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_TE <- metaregression_analysis1(df, "TvC", "Stress response", "TotalExercise1", 0.5)

```

**Figure 2.6.4.4 - Effect of exercise on biological stress response by total exercise**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
SMD_S_StR_TE$regression_plot
```

The p-value for the association between total exercise and biological stress response was `r ifelse(SMD_S_StR_TE$metaregression_summary$pval[2] < 0.001, "<0.001", sprintf("%.3f", SMD_S_StR_TE$metaregression_summary$pval[2]))`.

|            Level            |                                                                                      Number of categories for that level included in this analysis                                                                                      |                                                                                                          Attributable variance                                                                                                          |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_StR_TE$metaregression_summary$s.names, SMD_S_StR_TE$metaregression_summary$s.nlevels[[which(SMD_S_StR_TE$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_StR_TE$metaregression_summary$s.names, SMD_S_StR_TE$metaregression_summary$sigma2[[which(SMD_S_StR_TE$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_StR_TE$metaregression_summary$s.names, SMD_S_StR_TE$metaregression_summary$s.nlevels[[which(SMD_S_StR_TE$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_StR_TE$metaregression_summary$s.names, SMD_S_StR_TE$metaregression_summary$sigma2[[which(SMD_S_StR_TE$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_StR_TE$metaregression_summary$s.names, SMD_S_StR_TE$metaregression_summary$s.nlevels[[which(SMD_S_StR_TE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_StR_TE$metaregression_summary$s.names, SMD_S_StR_TE$metaregression_summary$sigma2[[which(SMD_S_StR_TE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considered as a categorical variable**

Figure 2.6.4.5 displays the estimates for the pooled SMD when comparisons are stratified by how many of the SyRCLE risk of bias assessment criteria (of which there are 10) that the experiment met. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by SyRCLE Risk of Bias, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.6.4.5 - Effect of exercise on biological stress response by SyRCLE RoB criteria**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_StR_SyRCLERoB <- subgroup_analysis(df, "TvC", "Stress response", "RoBScore", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "Stress response", "RoBScore", SMD_S_StR_SyRCLERoB, SMD_S_StR)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_SyRCLERoB_noI <- subgroup_SMD(df, "TvC", "Stress response", "RoBScore", 0.5)
```

The p-value for the association between SyRCLE Risks of Bias reporting and biological stress response was `r round(SMD_S_StR_SyRCLERoB_noI$QMp,3)`.

|       Level        |                                                                    Number of categories for that level included in this analysis                                                                     |                                                                                        Attributable variance                                                                                         |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_StR_SyRCLERoB$analysis$s.names, SMD_S_StR_SyRCLERoB$analysis$s.nlevels[[which(SMD_S_StR_SyRCLERoB$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_StR_SyRCLERoB$analysis$s.names, SMD_S_StR_SyRCLERoB$analysis$sigma2[[which(SMD_S_StR_SyRCLERoB$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_SyRCLERoB$analysis$s.names, SMD_S_StR_SyRCLERoB$analysis$s.nlevels[[which(SMD_S_StR_SyRCLERoB$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_SyRCLERoB$analysis$s.names, SMD_S_StR_SyRCLERoB$analysis$sigma2[[which(SMD_S_StR_SyRCLERoB$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considering those studies where any item is at low risk of bias**

Figure 2.6.4.6 displays the estimates for the pooled SMD when comparisons are stratified by whether of not any of the SyRCLE Risk of bias domains were rated as low risk of bias. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by SyRCLE Risk of Bias, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.6.4.6 - Effect of exercise on biological stress response by low SyRCLE RoB**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_StR_SyRCLERoBTF <- subgroup_analysis(df, "TvC", "Stress response", "RoBTF", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "Stress response", "RoBTF", SMD_S_StR_SyRCLERoBTF, SMD_S_StR)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_SyRCLERoBTF_noI <- subgroup_SMD(df, "TvC", "Stress response", "RoBTF", 0.5)
```

The p-value for the association between low SyRCLE Risks of Bias reporting and biological stress response was `r round(SMD_S_StR_SyRCLERoBTF_noI$QMp,3)`.

|       Level        |                                                                       Number of categories for that level included in this analysis                                                                        |                                                                                           Attributable variance                                                                                            |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_StR_SyRCLERoBTF$analysis$s.names, SMD_S_StR_SyRCLERoBTF$analysis$s.nlevels[[which(SMD_S_StR_SyRCLERoBTF$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_StR_SyRCLERoBTF$analysis$s.names, SMD_S_StR_SyRCLERoBTF$analysis$sigma2[[which(SMD_S_StR_SyRCLERoBTF$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_SyRCLERoBTF$analysis$s.names, SMD_S_StR_SyRCLERoBTF$analysis$s.nlevels[[which(SMD_S_StR_SyRCLERoBTF$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_SyRCLERoBTF$analysis$s.names, SMD_S_StR_SyRCLERoBTF$analysis$sigma2[[which(SMD_S_StR_SyRCLERoBTF$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **ARRIVE reporting completeness guidelines**

We provide a meta-regression where the number of ARRIVE items met is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_ARR2 <- metaregression_analysis(df, "TvC", "Stress response", "ARRIVEScore", 0.5)

```

**Figure 2.6.4.7 - Effect of exercise on biological stress response by ARRIVE reporting completeness**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_StR_ARR2$regression_plot
```

The p-value for the association between ARRIVE reporting completeness and biological stress response was `r round(SMD_S_StR_ARR2$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                         Number of categories for that level included in this analysis                                                                                         |                                                                                                             Attributable variance                                                                                                             |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$sigma2[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$sigma2[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$sigma2[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Heterogeneity explained by covariates (Effect of exercise on biological stress response)**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_StR_sexI <- subgroup_SMDI(df, "TvC", "Stress response", "Sex", 0.5)
SMD_S_StR_SyRCLERoBI <- subgroup_SMDI(df, "TvC", "Stress response", "RoBScore", 0.5)
SMD_S_StR_VoFI <- subgroup_SMDI(df, "TvC", "Stress response", "VoF", 0.5)
SMD_S_StR_ARRIVEI <- subgroup_SMDI(df, "TvC", "Stress response", "ARRIVEScoreCat", 0.5)
```

The table below shows which of the covariates, if any, explain some of the heterogeneity observed in the effect of exercise on biological stress response. We present marginal R^2^, which measures the proportion of variance explained by including moderators in the model (the % change in the between-studies variance when the covariate is included in the model, in other words the % of the heterogeneity explained by the variable). The coefficients are derived form an RMA model fitted with an intercept (and so represent, for each category, the point estimate and 95% CIs of the effect in that category).

|       Moderator        |             Category              |                      $\beta$                      |                                                  95% CI                                                  |                      Marginal R^2^ (%)                      |
|:------------:|:------------:|:------------:|:---------------:|:------------:|
|     Overall effect     |                \-                 |         `r SMD_S_StR[["SMD_ML"]]$beta[1]`         |                    `r SMD_S_StR[["SMD_ML"]]$ci.lb` to `r SMD_S_StR[["SMD_ML"]]$ci.ub`                    |                             \-                              |
|          Sex           |                \-                 |                        \-                         |                                                    \-                                                    |        `r round((r2_ml(SMD_S_StR_sexI)[1]*100),1)`%         |
|           \-           |             *Female*              |            `r SMD_S_StR_sexI$beta[1]`             |                        `r SMD_S_StR_sexI$ci.lb[1]` to `r SMD_S_StR_sexI$ci.ub[1]`                        |                             \-                              |
|           \-           |              *Male*               |            `r SMD_S_StR_sexI$beta[2]`             |                        `r SMD_S_StR_sexI$ci.lb[2]` to `r SMD_S_StR_sexI$ci.ub[2]`                        |                             \-                              |
| Duration of treatment  |                \-                 |                        \-                         |                                                    \-                                                    | `r round((r2_ml(SMD_S_StR_DOE$metaregression)[1]*100),1)`%  |
|           \-           | *per weeks of treatment increase* | `r SMD_S_StR_DOE$metaregression_summary$beta[2]`  |  `r SMD_S_StR_DOE$metaregression_summary$ci.lb[2]` to `r SMD_S_StR_DOE$metaregression_summary$ci.ub[2]`  |                             \-                              |
|   Exercise intensity   |                \-                 |                        \-                         |                                                    \-                                                    |  `r round((r2_ml(SMD_S_StR_EI$metaregression)[1]*100),1)`%  |
|           \-           |    *per unit (m/min) increase*    |  `r SMD_S_StR_EI$metaregression_summary$beta[2]`  |   `r SMD_S_StR_EI$metaregression_summary$ci.lb[2]` to `r SMD_S_StR_EI$metaregression_summary$ci.ub[2]`   |                             \-                              |
|     Total exercise     |                \-                 |                        \-                         |                                                    \-                                                    |  `r round((r2_ml(SMD_S_StR_TE$metaregression)[1]*100),1)`%  |
|           \-           |         *per km increase*         |  `r SMD_S_StR_TE$metaregression_summary$beta[2]`  |   `r SMD_S_StR_TE$metaregression_summary$ci.lb[2]` to `r SMD_S_StR_TE$metaregression_summary$ci.ub[2]`   |                             \-                              |
|      Risk of Bias      |                \-                 |                        \-                         |                                                    \-                                                    |     `r round((r2_ml(SMD_S_StR_SyRCLERoBI)[1]*100),1)`%      |
|           \-           |         *0 criteria met*          |         `r SMD_S_StR_SyRCLERoBI$beta[1]`          |                  `r SMD_S_StR_SyRCLERoBI$ci.lb[1]` to `r SMD_S_StR_SyRCLERoBI$ci.ub[1]`                  |                             \-                              |
|           \-           |         *1 criteria met*          |         `r SMD_S_StR_SyRCLERoBI$beta[2]`          |                  `r SMD_S_StR_SyRCLERoBI$ci.lb[2]` to `r SMD_S_StR_SyRCLERoBI$ci.ub[2]`                  |                             \-                              |
| Reporting completeness |                \-                 |                        \-                         |                                                    \-                                                    | `r round((r2_ml(SMD_S_StR_ARR2$metaregression)[1]*100),1)`% |
|           \-           |        *per unit increase*        | `r SMD_S_StR_ARR2$metaregression_summary$beta[2]` | `r SMD_S_StR_ARR2$metaregression_summary$ci.lb[2]` to `r SMD_S_StR_ARR2$metaregression_summary$ci.ub[2]` |                             \-                              |

### 2.6.5 Sensitivity Analyses

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen = 100, digits = 2)
```

We examine the robustness of the findings for biological stress response by performing the following sensitivity analyses.

#### Imputed rho values of 0.2 and 0.8

In the previous analyses for the effect of exercise on biological stress response, we imputed a $\rho$ value - the imputed within-study correlation between observed effect sizes - of 0.5. Here, we examine the effect of imputing $\rho$ values of 0.2 and 0.8.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_rho0.2 <- run_ML_SMD(df, "TvC", "Stress response", 0.2)
```

When the $\rho$ value is assumed to be 0.2, exercise had a pooled effect on biological stress response of **SMD = `r SMD_S_StR_rho0.2[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_StR_rho0.2[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_StR_rho0.2[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_StR_rho0.2[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_StR_rho0.2[["pred_interval"]][["pi.ub"]],3)`).

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_rho0.8 <- run_ML_SMD(df, "TvC", "Stress response", 0.8)
```

When the $\rho$ value is assumed to be 0.8, exercise had a pooled effect on biological stress response of **SMD = `r SMD_S_StR_rho0.8[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_StR_rho0.8[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_StR_rho0.8[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_StR_rho0.8[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_StR_rho0.8[["pred_interval"]][["pi.ub"]],3)`).

For reference the pooled effect size when rho is assumed to be 0.5 is `r SMD_S_StR[["SMD_ML"]][["beta"]]` (95% CI: `r SMD_S_StR[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_StR[["SMD_ML"]][["ci.ub"]]`).

### 2.6.6 Reporting bias/small-study effects

Because of the relationship between SMD effect sizes and variance inherent in their calculation, where study size is small the standard approach to seeking evidence of small-study effects (regression based tests including Egger's regression test for multilevel meta-analysis) can lead to over-estimation of small-study effect (see for instance [10.7554/eLife.24260](10.7554/eLife.24260)). To address this we used Egger's regression test for multilevel meta-analysis, with regression of SMD effect size against 1/√N, where N is the total number of animals involved in an experiment.

```{r warning=FALSE, eval = TRUE, echo = FALSE}
run_sse_plot_SMD_L(df, 'TvC', 'Stress response')
```

Egger regression based on `r run_sse_SMD_L(df, 'TvC', 'Stress response')[["k"]]` studies of modelling of depression where other neurobiological outcomes was measured showed a coefficient for a small-study effect of `r run_sse_SMD_L(df, 'TvC', 'Stress response')[["beta"]][2]` (95% CI: `r run_sse_SMD_L(df, 'TvC', 'Stress response')[["ci.lb"]][2]` to `r run_sse_SMD_L(df, 'TvC', 'Stress response')[["ci.ub"]][2]`; p = `r ifelse(run_sse_SMD_L(df, 'TvC', 'Stress response')[["pval"]][2] < 0.001, "<0.001", sprintf("%.3f", run_sse_SMD_L(df, 'TvC', 'Stress response')[["pval"]][2]))`).

## 2.7 Outcome 7: Neurotransmitter levels

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_NT <- run_SMD(df, "TvC", "Neurotransmitter levels")
# TvC levels 3-3-2
```

Multilevel analysis is only performed if there are 5 levels or more for at least one of Strain, Study and Experiment, and that is not the case here. `r SMD_S_NT[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_NT[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_NT[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_NT[["SMD_ML"]]$data$Strain))` different animal strain(s). We provide a conventional random effects model to illustrate the data. No subgroup analysis is performed. We also now include these Freezing outcomes under the 'other neurobiological' heading below.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
forest_metafor(SMD_S_NT, "TvC", "Neurotransmitter levels")
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
# since freezing no longer considered separately, edit df to 'other behavioural'
column_name <- 'outcome_type'
condition <- df$SortLabel == "TvC" & df$outcome_type == "Neurotransmitter levels"
df[condition, column_name] <- 'Other neurobiological'
```

## 2.8 Outcome 8: Other neurobiological outcomes

### 2.8.1 Risks of bias

Figure 2.8.1 shows the risk of bias summary for studies investigating the effect of exercise on other neurobiological outcomes in animals. The risk of bias assessment was performed using the SyRCLE RoB tool.

**Figure 2.8.1**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
SyRCLE_RoB_traffic(df, "TvC", "Other neurobiological")
```

### 2.8.2 Reporting completeness

Figure 2.8.2 shows the reporting completeness summary for studies investigating the effect of exercise on other neurobiological outcomes in animals. The reporting completeness assessment was performed using the ARRIVE guidelines.

**Figure 2.8.2**

```{r message = FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height = 8}
ARRIVE_traffic(df, "TvC", "Other neurobiological")
```

### 2.8.3 Meta-analysis

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN <- run_ML_SMD(df, "TvC", "Other neurobiological", 0.5)
```

The effect of exercise on other neurobiological outcomes in animals using SMD as the effect size is shown in Figure 2.8.3. The pooled estimate for SMD across all individual comparisons is displayed as a diamond shape at the bottom of the plot. Dotted lines indicate the prediction interval of the pooled estimate.

**Figure 2.8.3**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=14}
forest_metafor(SMD_S_OthN, "TvC", "Other neurobiological")
```

Exercise interventions had a pooled effect on other neurobiological outcomes induced by single prolonged stress of SMD = `r round(SMD_S_OthN[["SMD_ML"]][['beta']], 3)`, (95% CI: `r round(SMD_S_OthN[["SMD_ML"]][['ci.lb']], 3)` to `r round(SMD_S_OthN[["SMD_ML"]][['ci.ub']], 3)`; 95% PrI: `r round(SMD_S_OthN[["pred_interval"]][["pi.lb"]], 3)` to `r round(SMD_S_OthN[["pred_interval"]][["pi.ub"]], 3)`).

`r SMD_S_OthN[['SMD_ML']][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_OthN[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_OthN[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_OthN[["SMD_ML"]]$data$Strain))` different animal strain(s).

|       Level        |                                                           Number of categories for that level included in this analysis                                                            |                                                                               Attributable variance                                                                                |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OthN[["SMD_ML"]]$s.names, SMD_S_OthN[["SMD_ML"]]$s.nlevels[[which(SMD_S_OthN[["SMD_ML"]]$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OthN[["SMD_ML"]]$s.names, SMD_S_OthN[["SMD_ML"]]$sigma2[[which(SMD_S_OthN[["SMD_ML"]]$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OthN[["SMD_ML"]]$s.names, SMD_S_OthN[["SMD_ML"]]$s.nlevels[[which(SMD_S_OthN[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OthN[["SMD_ML"]]$s.names, SMD_S_OthN[["SMD_ML"]]$sigma2[[which(SMD_S_OthN[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

### 2.8.4 Subgroup analyses and meta-regressions

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen=100, digits=3)
```

For each outcome, the covariates of interest for subgroup analyses and meta-regressions were:

-   **Sex**
-   **Voluntary or forced exercise**
-   **Duration of exercise**
-   **Intensity of exercise**

We also conducted subgroup analyses using **(1) SyRCLE Risk of Bias** and **(2) ARRIVE reporting completeness** assessment scores as covariates to evaluate their influence on effect size estimates. These were not specified in the study protocol, but evaluation of risk of bias is required for the Summary of Evidence table, and no studies were considered entirely at low risk of bias or of high reporting completeness to allow such a sensitivity analysis.

The significance (p-value) reported is that for a test of whether the moderators are significantly different one from another, rather than whether the effect is significantly different from 0.

#### **Sex**

Figure 2.8.4.1 displays the estimates for the pooled SMD when comparisons are stratified by sex of the animal. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by sex, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.8.4.1 - Effect of exercise on other neurobiological outcomes by Sex**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_sex <- subgroup_analysis(df, "TvC", "Other neurobiological", "Sex", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "Other neurobiological", "Sex", SMD_S_OthN_sex, SMD_S_OthN)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_sex_noI <- subgroup_SMD(df, "TvC", "Other neurobiological", "Sex", 0.5)
```

The p-value for the association between the sex of animal groups used and other neurobiological outcomes was `r round(SMD_S_OthN_sex_noI$QMp,3)`.

|       Level        |                                                             Number of categories for that level included in this analysis                                                             |                                                                                 Attributable variance                                                                                 |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OthN_sex$analysis$s.names, SMD_S_OthN_sex$analysis$s.nlevels[[which(SMD_S_OthN_sex$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OthN_sex$analysis$s.names, SMD_S_OthN_sex$analysis$sigma2[[which(SMD_S_OthN_sex$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OthN_sex$analysis$s.names, SMD_S_OthN_sex$analysis$s.nlevels[[which(SMD_S_OthN_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OthN_sex$analysis$s.names, SMD_S_OthN_sex$analysis$sigma2[[which(SMD_S_OthN_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **Voluntary or forced exercise**

Figure 2.8.4.2 displays the estimates for the pooled SMD when comparisons are stratified by whether the exercise was voluntary or forced. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by sex, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 2.8.4.2 - Effect of exercise on other neurobiological outcomes by voluntary or forced exercise**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_VoF <- subgroup_analysis(df, "TvC", "Other neurobiological", "VoF", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "TvC", "Other neurobiological", "VoF", SMD_S_OthN_VoF, SMD_S_OthN)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_VoF_noI <- subgroup_SMDs(df, "TvC", "Other neurobiological", "VoF", 0.5)
```

The p-value for the association between the VoF of animal groups used and other neurobiological outcomes was `r round(SMD_S_OthN_VoF_noI$QMp,3)`.

|       Level        |                                                             Number of categories for that level included in this analysis                                                             |                                                                                 Attributable variance                                                                                 |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OthN_VoF$analysis$s.names, SMD_S_OthN_VoF$analysis$s.nlevels[[which(SMD_S_OthN_VoF$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OthN_VoF$analysis$s.names, SMD_S_OthN_VoF$analysis$sigma2[[which(SMD_S_OthN_VoF$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OthN_VoF$analysis$s.names, SMD_S_OthN_VoF$analysis$s.nlevels[[which(SMD_S_OthN_VoF$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OthN_VoF$analysis$s.names, SMD_S_OthN_VoF$analysis$sigma2[[which(SMD_S_OthN_VoF$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **Duration of treatment**

We provide a meta-regression of the number of weeks of treatment as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_DOE <- metaregression_analysis(df, "TvC", "Other neurobiological", "DurationOfTreatmentWeeks1", 0.5)

```

**Figure 2.8.4.3 - Effect of exercise on other neurobiological outcomes by duration of treatment**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_OthN_DOE$regression_plot
```

The p-value for the association between duration of treatment and other neurobiological outcomes was `r round(SMD_S_OthN_DOE$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                         Number of categories for that level included in this analysis                                                                                         |                                                                                                             Attributable variance                                                                                                             |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_OthN_DOE$metaregression_summary$s.names, SMD_S_OthN_DOE$metaregression_summary$s.nlevels[[which(SMD_S_OthN_DOE$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_OthN_DOE$metaregression_summary$s.names, SMD_S_OthN_DOE$metaregression_summary$sigma2[[which(SMD_S_OthN_DOE$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_OthN_DOE$metaregression_summary$s.names, SMD_S_OthN_DOE$metaregression_summary$s.nlevels[[which(SMD_S_OthN_DOE$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_OthN_DOE$metaregression_summary$s.names, SMD_S_OthN_DOE$metaregression_summary$sigma2[[which(SMD_S_OthN_DOE$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OthN_DOE$metaregression_summary$s.names, SMD_S_OthN_DOE$metaregression_summary$s.nlevels[[which(SMD_S_OthN_DOE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OthN_DOE$metaregression_summary$s.names, SMD_S_OthN_DOE$metaregression_summary$sigma2[[which(SMD_S_OthN_DOE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Exercise Intensity**

We provide a meta-regression where exercise intensity is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_EI <- metaregression_analysis(df, "TvC", "Other neurobiological", "EI1", 0.5)

```

**Figure 2.8.4.4 - Effect of exercise on other neurobiological outcomes by exercise intensity**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_OthN_EI$regression_plot
```

The p-value for the association between exercise intensity and outcome reported was `r  round(SMD_S_OthN_EI$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                       Number of categories for that level included in this analysis                                                                                        |                                                                                                           Attributable variance                                                                                                            |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_OthN_EI$metaregression_summary$s.names, SMD_S_OthN_EI$metaregression_summary$s.nlevels[[which(SMD_S_OthN_EI$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_OthN_EI$metaregression_summary$s.names, SMD_S_OthN_EI$metaregression_summary$sigma2[[which(SMD_S_OthN_EI$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_OthN_EI$metaregression_summary$s.names, SMD_S_OthN_EI$metaregression_summary$s.nlevels[[which(SMD_S_OthN_EI$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_OthN_EI$metaregression_summary$s.names, SMD_S_OthN_EI$metaregression_summary$sigma2[[which(SMD_S_OthN_EI$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OthN_EI$metaregression_summary$s.names, SMD_S_OthN_EI$metaregression_summary$s.nlevels[[which(SMD_S_OthN_EI$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OthN_EI$metaregression_summary$s.names, SMD_S_OthN_EI$metaregression_summary$sigma2[[which(SMD_S_OthN_EI$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Total exercise**

We provide a meta-regression where the total exercise as the product of the number of sessions, session duration, and session intensity, expressed in km, is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_TE <- metaregression_analysis1(df, "TvC", "Other neurobiological", "TotalExercise1", 0.5)

```

**Figure 2.8.4.5 - Effect of exercise on other neurobiological outcomes by total exercise**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_OthN_TE$regression_plot
```

The p-value for the association between total exercise and other neurobiological outcomes was `r ifelse(SMD_S_OthN_TE$metaregression_summary$pval[2] < 0.001, "<0.001", sprintf("%.3f", SMD_S_OthN_TE$metaregression_summary$pval[2]))`.

|            Level            |                                                                                       Number of categories for that level included in this analysis                                                                                        |                                                                                                           Attributable variance                                                                                                            |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_OthN_TE$metaregression_summary$s.names, SMD_S_OthN_TE$metaregression_summary$s.nlevels[[which(SMD_S_OthN_TE$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_OthN_TE$metaregression_summary$s.names, SMD_S_OthN_TE$metaregression_summary$sigma2[[which(SMD_S_OthN_TE$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_OthN_TE$metaregression_summary$s.names, SMD_S_OthN_TE$metaregression_summary$s.nlevels[[which(SMD_S_OthN_TE$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_OthN_TE$metaregression_summary$s.names, SMD_S_OthN_TE$metaregression_summary$sigma2[[which(SMD_S_OthN_TE$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OthN_TE$metaregression_summary$s.names, SMD_S_OthN_TE$metaregression_summary$s.nlevels[[which(SMD_S_OthN_TE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OthN_TE$metaregression_summary$s.names, SMD_S_OthN_TE$metaregression_summary$sigma2[[which(SMD_S_OthN_TE$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considered as a categorical variable**

No studies met any RoB criteria.

#### **SyRCLE RoB assessment considering those studies where any item is at low risk of bias**

No studies met any RoB criteria.

#### **ARRIVE reporting completeness guidelines**

We provide a meta-regression where the number of ARRIVE items met is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_ARR2 <- metaregression_analysis(df, "TvC", "Other neurobiological", "ARRIVEScore", 0.5)

```

**Figure 2.8.4.6 - Effect of exercise on other neurobiological outcomes by ARRIVE reporting completeness**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_OthN_ARR2$regression_plot
```

The p-value for the association between ARRIVE reporting completeness and other neurobiological outcomes was `r round(SMD_S_OthN_ARR2$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                          Number of categories for that level included in this analysis                                                                                           |                                                                                                              Attributable variance                                                                                                               |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$sigma2[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$sigma2[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$sigma2[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Heterogeneity explained by covariates (Effect of exercise on other neurobiological outcomes)**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_OthN_sexI <- subgroup_SMDI(df, "TvC", "Other neurobiological", "Sex", 0.5)
SMD_S_OthN_VoFI <- subgroup_SMDIs(df, "TvC", "Other neurobiological", "VoF", 0.5)
SMD_S_OthN_ARRIVEI <- subgroup_SMDI(df, "TvC", "Other neurobiological", "ARRIVEScoreCat", 0.5)
```

The table below shows which of the covariates, if any, explain some of the heterogeneity observed in the effect of exercise on other neurobiological outcomes. We present marginal R^2^, which measures the proportion of variance explained by including moderators in the model (the % change in the between-studies variance when the covariate is included in the model, in other words the % of the heterogeneity explained by the variable). The coefficients are derived form an RMA model fitted with an intercept (and so represent, for each category, the point estimate and 95% CIs of the effect in that category).

|       Moderator        |             Category              |                      $\beta$                       |                                                   95% CI                                                   |                      Marginal R^2^ (%)                       |
|:------------:|:------------:|:------------:|:---------------:|:------------:|
|     Overall effect     |                \-                 |         `r SMD_S_OthN[["SMD_ML"]]$beta[1]`         |                    `r SMD_S_OthN[["SMD_ML"]]$ci.lb` to `r SMD_S_OthN[["SMD_ML"]]$ci.ub`                    |                              \-                              |
|          Sex           |                \-                 |                         \-                         |                                                     \-                                                     |        `r round((r2_ml(SMD_S_OthN_sexI)[1]*100),1)`%         |
|           \-           |             *Female*              |            `r SMD_S_OthN_sexI$beta[1]`             |                        `r SMD_S_OthN_sexI$ci.lb[1]` to `r SMD_S_OthN_sexI$ci.ub[1]`                        |                              \-                              |
|           \-           |              *Male*               |            `r SMD_S_OthN_sexI$beta[2]`             |                        `r SMD_S_OthN_sexI$ci.lb[2]` to `r SMD_S_OthN_sexI$ci.ub[2]`                        |                              \-                              |
|  Voluntary or forced   |                \-                 |                         \-                         |                                                     \-                                                     |        `r round((r2_ml(SMD_S_OthN_VoFI)[1]*100),1)`%         |
|           \-           |             *Forced*              |            `r SMD_S_OthN_VoFI$beta[1]`             |                        `r SMD_S_OthN_VoFI$ci.lb[1]` to `r SMD_S_OthN_VoFI$ci.ub[1]`                        |                              \-                              |
|           \-           |            *Voluntary*            |            `r SMD_S_OthN_VoFI$beta[2]`             |                        `r SMD_S_OthN_VoFI$ci.lb[2]` to `r SMD_S_OthN_VoFI$ci.ub[2]`                        |                              \-                              |
| Duration of treatment  |                \-                 |                         \-                         |                                                     \-                                                     | `r round((r2_ml(SMD_S_OthN_DOE$metaregression)[1]*100),1)`%  |
|           \-           | *per weeks of treatment increase* | `r SMD_S_OthN_DOE$metaregression_summary$beta[2]`  |  `r SMD_S_OthN_DOE$metaregression_summary$ci.lb[2]` to `r SMD_S_OthN_DOE$metaregression_summary$ci.ub[2]`  |                              \-                              |
|   Exercise intensity   |                \-                 |                         \-                         |                                                     \-                                                     |  `r round((r2_ml(SMD_S_OthN_EI$metaregression)[1]*100),1)`%  |
|           \-           |    *per unit (m/min) increase*    |  `r SMD_S_OthN_EI$metaregression_summary$beta[2]`  |   `r SMD_S_OthN_EI$metaregression_summary$ci.lb[2]` to `r SMD_S_OthN_EI$metaregression_summary$ci.ub[2]`   |                              \-                              |
|     Total exercise     |                \-                 |                         \-                         |                                                     \-                                                     |  `r round((r2_ml(SMD_S_OthN_TE$metaregression)[1]*100),1)`%  |
|           \-           |         *per km increase*         |  `r SMD_S_OthN_TE$metaregression_summary$beta[2]`  |   `r SMD_S_OthN_TE$metaregression_summary$ci.lb[2]` to `r SMD_S_OthN_TE$metaregression_summary$ci.ub[2]`   |                              \-                              |
| Reporting completeness |                \-                 |                         \-                         |                                                     \-                                                     | `r round((r2_ml(SMD_S_OthN_ARR2$metaregression)[1]*100),1)`% |
|           \-           |        *per unit increase*        | `r SMD_S_OthN_ARR2$metaregression_summary$beta[2]` | `r SMD_S_OthN_ARR2$metaregression_summary$ci.lb[2]` to `r SMD_S_OthN_ARR2$metaregression_summary$ci.ub[2]` |                              \-                              |

### 2.8.5 Sensitivity Analyses

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen = 100, digits = 2)
```

We examine the robustness of the findings for the primary outcome by performing the following sensitivity analyses.

#### Imputed rho values of 0.2 and 0.8

In the previous analyses for the effect of exercise on other neurobiological outcomes, we imputed a $\rho$ value - the imputed within-study correlation between observed effect sizes - of 0.5. Here, we examine the effect of imputing $\rho$ values of 0.2 and 0.8.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_rho0.2 <- run_ML_SMD(df, "TvC", "Other neurobiological", 0.2)
```

When the $\rho$ value is assumed to be 0.2, exercise had a pooled effect on other neurobiological outcomes of **SMD = `r round(SMD_S_OthN_rho0.2[["SMD_ML"]][["beta"]],3)`** (95% CI: `r round(SMD_S_OthN_rho0.2[["SMD_ML"]][["ci.lb"]],3)` to `r round(SMD_S_OthN_rho0.2[["SMD_ML"]][["ci.ub"]],3)`; 95% PrI: `r round(SMD_S_OthN_rho0.2[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_OthN_rho0.2[["pred_interval"]][["pi.ub"]],3)`).

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_rho0.8 <- run_ML_SMD(df, "TvC", "Other neurobiological", 0.8)
```

When the $\rho$ value is assumed to be 0.8, exercise had a pooled effect on other neurobiological outcomes of **SMD = `r round(SMD_S_OthN_rho0.8[["SMD_ML"]][["beta"]],3)`** (95% CI: `r round(SMD_S_OthN_rho0.8[["SMD_ML"]][["ci.lb"]],3)` to `r round(SMD_S_OthN_rho0.8[["SMD_ML"]][["ci.ub"]],3)`; 95% PrI: `r round(SMD_S_OthN_rho0.8[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_OthN_rho0.8[["pred_interval"]][["pi.ub"]],3)`).

For reference the pooled effect size when rho is assumed to be 0.5 is `r round(SMD_S_OthN[['SMD_ML']][["beta"]],3)` (95% CI: `r round(SMD_S_OthN[['SMD_ML']][["ci.lb"]],3)` to `r round(SMD_S_OthN[['SMD_ML']][["ci.ub"]],3)`.

### 2.8.6 Reporting bias/small-study effects

Because of the relationship between SMD effect sizes and variance inherent in their calculation, where study size is small the standard approach to seeking evidence of small-study effects (regression based tests including Egger's regression test for multilevel meta-analysis) can lead to over-estimation of small-study effect (see for instance [10.7554/eLife.24260](10.7554/eLife.24260)). To address this we used Egger's regression test for multilevel meta-analysis, with regression of SMD effect size against 1/√N, where N is the total number of animals involved in an experiment.

```{r warning=FALSE, eval = TRUE, echo = FALSE}
run_sse_plot_SMD_L(df, 'TvC', 'Other neurobiological')
#run_sse_NMD(df)
```

Egger regression based on `r run_sse_SMD_L(df, 'TvC', 'Other neurobiological')[["k"]]` studies of modelling of depression where other neurobiological outcomes was measured showed a coefficient for a small-study effect of `r run_sse_SMD_L(df, 'TvC', 'Other neurobiological')[["beta"]][2]` (95% CI: `r run_sse_SMD_L(df, 'TvC', 'Other neurobiological')[["ci.lb"]][2]` to `r run_sse_SMD_L(df, 'TvC', 'Other neurobiological')[["ci.ub"]][2]`; p = `r ifelse(run_sse_SMD_L(df, 'TvC', 'Other neurobiological')[["pval"]][2] < 0.001, "<0.001", sprintf("%.3f", run_sse_SMD_L(df, 'TvC', 'Other neurobiological')[["pval"]][2]))`).

# 3 Effects of model induction (SPS)

```{r # Split df by experiment and outcome type into dataframes to simply inline code below - Control v Sham, eval = TRUE, echo = FALSE}
df_S <- filter(df, SortLabel == "CvS")
df_S_NT <- filter_experiment_outcome_type(df, "CvS", "Neurotransmitter levels")
df_S_L <- filter_experiment_outcome_type(df, "CvS", "Locomotor")
df_S_B <- filter_experiment_outcome_type(df, "CvS", "BDNF")
df_S_OB <- filter_experiment_outcome_type(df, "CvS", "Other behavioural")
df_S_OthN <- filter_experiment_outcome_type(df, "CvS", "Other neurobiological")
df_S_FM <- filter_experiment_outcome_type(df, "CvS", "Fear memory")
df_S_Fr <- filter_experiment_outcome_type(df, "CvS", "Freezing")
df_S_StR<- filter_experiment_outcome_type(df, "CvS", "Stress response")
```

`r length(table(df_S$StudyId))` studies (`r nrow(df%>%filter(SortLabel == "CvS"))` comparisons) investigated the effects of model induction. The number of studies and individual effect sizes for each outcome were:

-   Locomotor outcomes: `r length(table(df_S_L$StudyId))` studies and `r nrow(df_S_L)` comparisons in `r {strains <- unique(df_S_L$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Fear Memory `r length(table(df_S_FM$StudyId))` studies and `r nrow(df_S_FM)` comparisons in `r {strains <- unique(df_S_FM$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Freezing: `r length(table(df_S_Fr$StudyId))` studies and `r nrow(df_S_Fr)` comparisons in `r {strains <- unique(df_S_Fr$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Other behaviours: `r length(table(df_S_OB$StudyId))` studies and `r nrow(df_S_OB)` comparisons in `r {strains <- unique(df_S_OB$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   BDNF: `r length(table(df_S_B$StudyId))` studies and `r nrow(df_S_B)` comparisons in `r {strains <- unique(df_S_B$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Neurotransmitter levels: `r length(table(df_S_NT$StudyId))` studies and `r nrow(df_S_NT)` comparisons in `r {strains <- unique(df_S_NT$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Biochemical stress responses: `r length(table(df_S_StR$StudyId))` studies and `r nrow(df_S_StR)` comparisons in `r {strains <- unique(df_S_StR$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

-   Other neurobiological outcomes: `r length(table(df_S_OthN$StudyId))` studies and `r nrow(df_S_OthN)` comparisons in `r {strains <- unique(df_S_OthN$Strain); if (length(strains) > 1) paste(length(strains), "strains") else paste(length(strains), "strain")}`

## 3.1 Outcome 1: Locomotor activity

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_L <- run_SMD(df, "CvS", "Locomotor")
#levels 4,4,2 so stop
```

Multilevel analysis is only performed if there are 5 levels or more for at least one of Strain, Study and Experiment, and that is not the case here. `r SMD_S_L[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_L[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_L[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_L[["SMD_ML"]]$data$Strain))` different animal strain(s). We provide a conventional random effects model to illustrate the data. No subgroup analysis is performed. We also now include these locomotor outcomes under the 'other behavioural' heading below.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
forest_metafor(SMD_S_L, "CvS", "Locomotor")
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
# since locomotor no longer considered separately, edit df to 'other behavioural'
column_name <- 'outcome_type'
condition <- df$SortLabel == "CvS" & df$outcome_type == "Locomotor"
df[condition, column_name] <- 'Other behavioural'
```

## 3.2 Outcome 2: Fear memory

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_FM <- run_SMD(df, "CvS", "Fear memory")
#levels 4-4-1
```

Multilevel analysis is only performed if there are 5 levels or more for at least one of Strain, Study and Experiment, and that is not the case here. `r SMD_S_FM[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_FM[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_FM[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_FM[["SMD_ML"]]$data$Strain))` different animal strain(s). We provide a conventional random effects model to illustrate the data. No subgroup analysis is performed. We also now include these fear memory outcomes under the 'other behavioural' heading below.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
forest_metafor(SMD_S_FM, "CvS", "Fear memory")
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
# since fear memory no longer considered separately, edit df to 'other behavioural'
column_name <- 'outcome_type'
condition <- df$SortLabel == "CvS" & df$outcome_type == "Fear memory"
df[condition, column_name] <- 'Other behavioural'

column_name <- 'outcome_type'
condition <- df$SortLabel == "AvC" & df$outcome_type == "Fear memory"
df[condition, column_name] <- 'Other behavioural'
```

## 3.3 Outcome 3: Freezing

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_Fr <- run_SMD(df, "CvS", "Freezing")
# levels 3-3-2
```

Multilevel analysis is only performed if there are 5 levels or more for at least one of Strain, Study and Experiment, and that is not the case here. `r SMD_S_Fr[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_Fr[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_Fr[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_Fr[["SMD_ML"]]$data$Strain))` different animal strain(s). We provide a conventional random effects model to illustrate the data. No subgroup analysis is performed. We also now include these freezing outcomes under the 'other behavioural' heading below.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
forest_metafor(SMD_S_Fr, "CvS", "Freezing")
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
# since freezing no longer considered separately, edit df to 'other behavioural'
column_name <- 'outcome_type'
condition <- df$SortLabel == "CvS" & df$outcome_type == "Freezing"
df[condition, column_name] <- 'Other behavioural'
```

## 3.4 Outcome 4: Other behavioural outcomes

### 3.4.1 Risks of bias

Figure 3.4.1 shows the risk of bias summary for studies investigating the effect of single prolonged stress on other behavioural outcomes in animals. The risk of bias assessment was performed using the SyRCLE RoB tool.

**Figure 3.4.1**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=8}
SyRCLE_RoB_traffic(df, "CvS", "Other behavioural")
```

### 3.4.2 Reporting completeness

Figure 3.4.2 shows the reporting completeness summary for studies investigating the effect of single prolonged stress on sucrose preference in animals. The reporting completeness assessment was performed using the ARRIVE guidelines.

**Figure 3.4.2**

```{r message = FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height = 10}
ARRIVE_traffic(df, "CvS", "Other behavioural")
```

### 3.4.3 Meta-analysis

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB <- run_ML_SMD(df, "CvS", "Other behavioural", 0.5)
```

The effect of single prolonged stress on other behaviours in animals using SMD as the effect size is shown in Figure 3.4.3. The pooled estimate for SMD across all individual comparisons is displayed as a diamond shape at the bottom of the plot. Dotted lines indicate the prediction interval of the pooled estimate.

**Figure 3.4.3**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height = 15}
forest_metafor(SMD_S_OB, "CvS", "Other behavioural")
```

Single prolonged stress had a pooled effect on other behaviours of SMD = `r round(SMD_S_OB[["SMD_ML"]][['beta']], 3)`, (95% CI: `r round(SMD_S_OB[["SMD_ML"]][['ci.lb']], 3)` to `r round(SMD_S_OB[["SMD_ML"]][['ci.ub']], 3)`; 95% PrI: `r round(SMD_S_OB[["pred_interval"]][["pi.lb"]], 3)` to `r round(SMD_S_OB[["pred_interval"]][["pi.ub"]], 3)`).

`r SMD_S_OB[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_OB[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_OB[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_OB[["SMD_ML"]]$data$Strain))` different animal strain(s).

The following table structure is used throughout this report and is used to show the different levels contributing to that analysis, the number of unique categories in those levels, and the variance contributed by that level of analysis. Because levels are only included in the analysis where there are five or more unique categories, for some analyses the number of categories is 0, and the variance attributed to those levels in not applicable. Because the model is hierarchical, where for instance there are **Studies** which include different **Strains**, the number of categories for **Study x Strain** will exceed the number of Studies (by which we mean unique publications) referred to in the text.

|       Level        |                                                        Number of categories for that level included in this analysis                                                         |                                                                            Attributable variance                                                                             |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OB[["SMD_ML"]]$s.names, SMD_S_OB[["SMD_ML"]]$s.nlevels[[which(SMD_S_OB[["SMD_ML"]]$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OB[["SMD_ML"]]$s.names, SMD_S_OB[["SMD_ML"]]$sigma2[[which(SMD_S_OB[["SMD_ML"]]$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB[["SMD_ML"]]$s.names, SMD_S_OB[["SMD_ML"]]$s.nlevels[[which(SMD_S_OB[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB[["SMD_ML"]]$s.names, SMD_S_OB[["SMD_ML"]]$sigma2[[which(SMD_S_OB[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

### 3.4.4 Subgroup analyses and meta-regressions

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen=100, digits=3)
```

For each outcome, the covariates of interest for subgroup analyses and meta-regressions were:

-   **Sex**

We also conducted subgroup analyses using **(1) SyRCLE Risk of Bias** and **(2) ARRIVE reporting completeness** assessment scores as covariates to evaluate their influence on effect size estimates. These were not specified in the study protocol, but evaluation of risk of bias is required for the Summary of Evidence table, and no studies were considered entirely at low risk of bias or of high reporting completeness to allow such a sensitivity analysis

The significance (p-value) reported is that for a test of whether the moderators are significantly different one from another, rather than whether the effect is significantly different from 0.

#### **Sex**

Figure 3.4.4.1 displays the estimates for the pooled SMD's when comparisons are stratified by sex of the animal. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by sex, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 3.4.4.1 - Effect of single prolonged stress on other behavioural outcomes by Sex**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_sex <- subgroup_analysis(df, "CvS", "Other behavioural", "Sex", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "CvS", "Other behavioural", "Sex", SMD_S_OB_sex, SMD_S_OB)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_sex_noI <- subgroup_SMD(df, "CvS", "Other behavioural", "Sex", 0.5)
```

The p-value for the association between the sex of animal groups used and outcome reported was `r round(SMD_S_OB_sex_noI$QMp,3)`.

|       Level        |                                                          Number of categories for that level included in this analysis                                                          |                                                                              Attributable variance                                                                              |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OB_sex$analysis$s.names, SMD_S_OB_sex$analysis$s.nlevels[[which(SMD_S_OB_sex$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OB_sex$analysis$s.names, SMD_S_OB_sex$analysis$sigma2[[which(SMD_S_OB_sex$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_sex$analysis$s.names, SMD_S_OB_sex$analysis$s.nlevels[[which(SMD_S_OB_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_sex$analysis$s.names, SMD_S_OB_sex$analysis$sigma2[[which(SMD_S_OB_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considered as a categorical variable**

Figure 3.4.4.3 displays the estimates for the pooled SMD's when comparisons are stratified by how many of the SyRCLE risk of bias assessment criteria (of which there are 10) that the experiment met. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by SyRCLE Risk of Bias, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 3.4.4.3 - Effect of single prolonged stress on other behavioural outcomes by SyRCLE RoB criteria**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_OB_SyRCLERoB <- subgroup_analysis(df, "CvS", "Other behavioural", "RoBScore", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "CvS", "Other behavioural", "RoBScore", SMD_S_OB_SyRCLERoB, SMD_S_OB)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_SyRCLERoB_noI <- subgroup_SMD(df, "CvS", "Other behavioural", "RoBScore", 0.5)
```

The p-value for the association between SyRCLE Risks of Bias reporting and outcome reported was `r round(SMD_S_OB_SyRCLERoB_noI$QMp,3)`.

|       Level        |                                                                   Number of categories for that level included in this analysis                                                                   |                                                                                       Attributable variance                                                                                       |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OB_SyRCLERoB$analysis$s.names, SMD_S_OB_SyRCLERoB$analysis$s.nlevels[[which(SMD_S_OB_SyRCLERoB$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OB_SyRCLERoB$analysis$s.names, SMD_S_OB_SyRCLERoB$analysis$sigma2[[which(SMD_S_OB_SyRCLERoB$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_SyRCLERoB$analysis$s.names, SMD_S_OB_SyRCLERoB$analysis$s.nlevels[[which(SMD_S_OB_SyRCLERoB$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_SyRCLERoB$analysis$s.names, SMD_S_OB_SyRCLERoB$analysis$sigma2[[which(SMD_S_OB_SyRCLERoB$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considering those studies where any item is at low risk of bias**

Figure 3.4.4.4 displays the estimates for the pooled SMD's when comparisons are stratified by whether of not any of the SyRCLE Risk of bias domains were rated as low risk of bias. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by SyRCLE Risk of Bias, is displayed as a diamond shape at the bottom of the plot.

**Figure 3.4.4.4 - Effect of single prolonged stress on other behavioural outcomes by low SyRCLE RoB**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_OB_SyRCLERoBTF <- subgroup_analysis(df, "CvS", "Other behavioural", "RoBTF", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "CvS", "Other behavioural", "RoBTF", SMD_S_OB_SyRCLERoBTF, SMD_S_OB)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_SyRCLERoBTF_noI <- subgroup_SMD(df, "CvS", "Other behavioural", "RoBTF", 0.5)
```

The p-value for the association between low SyRCLE Risks of Bias reporting and outcome reported was `r round(SMD_S_OB_SyRCLERoBTF_noI$QMp,3)`.

|       Level        |                                                                      Number of categories for that level included in this analysis                                                                      |                                                                                          Attributable variance                                                                                          |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OB_SyRCLERoBTF$analysis$s.names, SMD_S_OB_SyRCLERoBTF$analysis$s.nlevels[[which(SMD_S_OB_SyRCLERoBTF$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OB_SyRCLERoBTF$analysis$s.names, SMD_S_OB_SyRCLERoBTF$analysis$sigma2[[which(SMD_S_OB_SyRCLERoBTF$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_SyRCLERoBTF$analysis$s.names, SMD_S_OB_SyRCLERoBTF$analysis$s.nlevels[[which(SMD_S_OB_SyRCLERoBTF$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OB_SyRCLERoBTF$analysis$s.names, SMD_S_OB_SyRCLERoBTF$analysis$sigma2[[which(SMD_S_OB_SyRCLERoBTF$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **ARRIVE reporting completeness guidelines**

We provide a meta-regression where the number of ARRIVE items met is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_ARR2 <- metaregression_analysis(df, "CvS", "Other behavioural", "ARRIVEScore", 0.5)

```

**Figure 3.4.4.5 - Effect of single prolonged stress on other behavioural outcomes by ARRIVE reporting completeness**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_OB_ARR2$regression_plot
```

The p-value for the association between ARRIVE reporting completeness and outcome reported was `r  round(SMD_S_OB_ARR2$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                       Number of categories for that level included in this analysis                                                                                        |                                                                                                           Attributable variance                                                                                                            |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$sigma2[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$sigma2[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OB_ARR2$metaregression_summary$s.names, SMD_S_OB_ARR2$metaregression_summary$sigma2[[which(SMD_S_OB_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Heterogeneity explained by covariates (Effect of modelling on Behaviour not otherwise specified)**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_OB_sexI <- subgroup_SMDI(df, "CvS", "Other behavioural", "Sex", 0.5)
SMD_S_OB_SyRCLERoBI <- subgroup_SMDI(df, "CvS", "Other behavioural", "RoBScore", 0.5)
SMD_S_OB_ARRIVEI <- subgroup_SMDI(df, "CvS", "Other behavioural", "ARRIVEScoreCat", 0.5)
```

The table below shows which of the covariates, if any, explain some of the heterogeneity observed in the effect of model induction on other behavioural outcomes. We present marginal R^2^, which measures the proportion of variance explained by including moderators in the model (the % change in the between-studies variance when the covariate is included in the model, in other words the % of the heterogeneity explained by the variable). The coefficients are derived form an RMA model fitted with an intercept (and so represent, for each category, the point estimate and 95% CIs of the effect in that category).

|       Moderator        |      Category       |                     $\beta$                      |                                                 95% CI                                                 |                     Marginal R^2^ (%)                      |
|:------------:|:------------:|:------------:|:----------------:|:------------:|
|     Overall effect     |         \-          |         `r SMD_S_OB[["SMD_ML"]]$beta[1]`         |                    `r SMD_S_OB[["SMD_ML"]]$ci.lb` to `r SMD_S_OB[["SMD_ML"]]$ci.ub`                    |                             \-                             |
|          Sex           |         \-          |                        \-                        |                                                   \-                                                   |        `r round((r2_ml(SMD_S_OB_sexI)[1]*100),1)`%         |
|           \-           |      *Female*       |            `r SMD_S_OB_sexI$beta[1]`             |                        `r SMD_S_OB_sexI$ci.lb[1]` to `r SMD_S_OB_sexI$ci.ub[1]`                        |                             \-                             |
|           \-           |       *Male*        |            `r SMD_S_OB_sexI$beta[2]`             |                        `r SMD_S_OB_sexI$ci.lb[2]` to `r SMD_S_OB_sexI$ci.ub[2]`                        |                             \-                             |
|      Risk of Bias      |         \-          |                        \-                        |                                                   \-                                                   |     `r round((r2_ml(SMD_S_OB_SyRCLERoBI)[1]*100),1)`%      |
|           \-           |  *0 criteria met*   |         `r SMD_S_OB_SyRCLERoBI$beta[1]`          |                  `r SMD_S_OB_SyRCLERoBI$ci.lb[1]` to `r SMD_S_OB_SyRCLERoBI$ci.ub[1]`                  |                             \-                             |
|           \-           |  *1 criteria met*   |         `r SMD_S_OB_SyRCLERoBI$beta[2]`          |                  `r SMD_S_OB_SyRCLERoBI$ci.lb[2]` to `r SMD_S_OB_SyRCLERoBI$ci.ub[2]`                  |                             \-                             |
| Reporting completeness |         \-          |                        \-                        |                                                   \-                                                   | `r round((r2_ml(SMD_S_OB_ARR2$metaregression)[1]*100),1)`% |
|           \-           | *per unit increase* | `r SMD_S_OB_ARR2$metaregression_summary$beta[2]` | `r SMD_S_OB_ARR2$metaregression_summary$ci.lb[2]` to `r SMD_S_OB_ARR2$metaregression_summary$ci.ub[2]` |                             \-                             |

### 3.4.5 Sensitivity Analyses

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen = 100, digits = 2)
```

We examine the robustness of the findings for other behaviours by performing the following sensitivity analyses.

#### Imputed rho values of 0.2 and 0.8

In the previous analyses for the effect of single prolonged stress on other behaviours, we imputed a $\rho$ value - the imputed within-study correlation between observed effect sizes - of 0.5. Here, we examine the effect of imputing $\rho$ values of 0.2 and 0.8.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_rho0.2 <- run_ML_SMD(df, "CvS", "Other behavioural", 0.2)
```

When the $\rho$ value is assumed to be 0.2, single prolonged stress had a pooled effect on other behaviours of **SMD = `r SMD_S_OB_rho0.2[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_OB_rho0.2[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_OB_rho0.2[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_OB_rho0.2[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_OB_rho0.2[["pred_interval"]][["pi.ub"]],3)`).

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OB_rho0.8 <- run_ML_SMD(df, "CvS", "Other behavioural", 0.8)
```

When the $\rho$ value is assumed to be 0.8, single prolonged stress had a pooled effect on other behaviours of **SMD = `r SMD_S_OB_rho0.8[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_OB_rho0.8[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_OB_rho0.8[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_OB_rho0.8[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_OB_rho0.8[["pred_interval"]][["pi.ub"]],3)`).

For reference the pooled effect size when rho is assumed to be 0.5 is `r SMD_S_OB[["SMD_ML"]][["beta"]]` (95% CI: `r SMD_S_OB[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_OB[["SMD_ML"]][["ci.ub"]]`).

### 3.4.6 Reporting bias/small-study effects

Because of the relationship between SMD effect sizes and variance inherent in their calculation, where study size is small the standard approach to seeking evidence of small-study effects (regression based tests including Egger's regression test for multilevel meta-analysis) can lead to over-estimation of small-study effect (see for instance [10.7554/eLife.24260](10.7554/eLife.24260)). To address this we used Egger's regression test for multilevel meta-analysis, with regression of SMD effect size against 1/√N, where N is the total number of animals involved in an experiment.

```{r warning=FALSE, eval = TRUE, echo = FALSE}
run_sse_plot_SMD_L(df, 'CvS', 'Other behavioural')
#run_sse_NMD(df)
```

Egger regression based on `r run_sse_SMD_L(df, 'CvS', 'Other behavioural')[["k"]]` studies of modelling of depression where sucrose preference was measured showed a coefficient for a small-study effect of `r run_sse_SMD_L(df, 'CvS', 'Other behavioural')[["beta"]][2]` (95% CI: `r run_sse_SMD_L(df, 'CvS', 'Other behavioural')[["ci.lb"]][2]` to `r run_sse_SMD_L(df, 'CvS', 'Other behavioural')[["ci.ub"]][2]`; p = `r ifelse(run_sse_SMD_L(df, 'CvS', 'Other behavioural')[["pval"]][2] < 0.001, "<0.001", sprintf("%.3f", run_sse_SMD_L(df, 'CvS', 'Other behavioural')[["pval"]][2]))`).

## 3.5 Outcome 5: BDNF

### 3.5.1 Risks of bias

Figure 3.5.1 shows the risk of bias summary for studies investigating the effect of single prolonged stress on sucrose preference in animals. The risk of bias assessment was performed using the SyRCLE RoB tool.

**Figure 3.5.1**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
SyRCLE_RoB_traffic(df, "CvS", "BDNF")
```

### 3.5.2 Reporting completeness

Figure 3.5.2 shows the reporting completeness summary for studies investigating the effect of single prolonged stress on sucrose preference in animals. The reporting completeness assessment was performed using the ARRIVE guidelines.

**Figure 3.5.2**

```{r message = FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height = 6}
ARRIVE_traffic(df, "CvS", "Stress response")
```

### 3.5.3 Meta-analysis

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B <- run_ML_SMD(df, "CvS", "BDNF", 0.5)
```

The effect of single prolonged stress on BDNF in animals using SMD as the effect size is shown in Figure 3.5.3. The pooled estimate for SMD across all individual comparisons is displayed as a diamond shape at the bottom of the plot. Dotted lines indicate the prediction interval of the pooled estimate.

**Figure 3.5.3**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=8}
forest_metafor(SMD_S_B, "CvS", "BDNF")
```

Single prolonged stress had a pooled effect on BDNF of SMD = `r round(SMD_S_B[["SMD_ML"]][['beta']], 3)`, (95% CI: `r round(SMD_S_B[["SMD_ML"]][['ci.lb']], 3)` to `r round(SMD_S_B[["SMD_ML"]][['ci.ub']], 3)`; 95% PrI: `r round(SMD_S_B[["pred_interval"]][["pi.lb"]], 3)` to `r round(SMD_S_B[["pred_interval"]][["pi.ub"]], 3)`).

`r SMD_S_B[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_B[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_B[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_B[["SMD_ML"]]$data$Strain))` different animal strain(s).

|       Level        |                                                       Number of categories for that level included in this analysis                                                       |                                                                           Attributable variance                                                                           |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_B[["SMD_ML"]]$s.names, SMD_S_B[["SMD_ML"]]$s.nlevels[[which(SMD_S_B[["SMD_ML"]]$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_B[["SMD_ML"]]$s.names, SMD_S_B[["SMD_ML"]]$sigma2[[which(SMD_S_B[["SMD_ML"]]$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_B[["SMD_ML"]]$s.names, SMD_S_B[["SMD_ML"]]$s.nlevels[[which(SMD_S_B[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_B[["SMD_ML"]]$s.names, SMD_S_B[["SMD_ML"]]$sigma2[[which(SMD_S_B[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

### 3.5.4 Subgroup analyses and meta-regressions

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen=100, digits=3)
```

For each outcome, the covariates of interest for subgroup analyses and meta-regressions were:

-   **Sex**

We also conducted subgroup analyses using **(1) SyRCLE Risk of Bias** and **(2) ARRIVE reporting completeness** assessment scores as covariates to evaluate their influence on effect size estimates. These were not specified in the study protocol, but evaluation of risk of bias is required for the Summary of Evidence table, and no studies were considered entirely at low risk of bias or of high reporting completeness to allow such a sensitivity analysis

The significance (p-value) reported is that for a test of whether the moderators are significantly different one from another, rather than whether the effect is significantly different from 0.

#### **Sex**

Figure 3.5.4.1 displays the estimates for the pooled SMD's when comparisons are stratified by sex of the animal. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by sex, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 3.5.4.1 - Effect of single prolonged stress on BDNF by Sex**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_sex <- subgroup_analysis(df, "CvS", "BDNF", "Sex", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "CvS", "BDNF", "Sex", SMD_S_B_sex, SMD_S_B)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_sex_noI <- subgroup_SMD(df, "CvS", "BDNF", "Sex", 0.5)
```

The p-value for the association between the sex of animal groups used and outcome reported was `r round(SMD_S_B_sex_noI$QMp,3)`.

|       Level        |                                                        Number of categories for that level included in this analysis                                                         |                                                                            Attributable variance                                                                             |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_B_sex$analysis$s.names, SMD_S_B_sex$analysis$s.nlevels[[which(SMD_S_B_sex$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_B_sex$analysis$s.names, SMD_S_B_sex$analysis$sigma2[[which(SMD_S_B_sex$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_B_sex$analysis$s.names, SMD_S_B_sex$analysis$s.nlevels[[which(SMD_S_B_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_B_sex$analysis$s.names, SMD_S_B_sex$analysis$sigma2[[which(SMD_S_B_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considered as a categorical variable**

No studies met any RoB criteria

#### **SyRCLE RoB assessment considering those studies where any item is at low risk of bias**

No studies met any RoB criteria

#### **ARRIVE reporting completeness guidelines**

We provide a meta-regression where the number of ARRIVE items met is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_ARR2 <- metaregression_analysis(df, "CvS", "BDNF", "ARRIVEScore", 0.5)

```

**Figure 3.5.4.2 - Effect of single prolonged stress on BDNF by ARRIVE reporting completeness**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_B_ARR2$regression_plot
```

The p-value for the association between ARRIVE reporting completeness and outcome reported was `r  round(SMD_S_B_ARR2$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                      Number of categories for that level included in this analysis                                                                                      |                                                                                                          Attributable variance                                                                                                          |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$sigma2[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$sigma2[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_B_ARR2$metaregression_summary$s.names, SMD_S_B_ARR2$metaregression_summary$sigma2[[which(SMD_S_B_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Heterogeneity explained by covariates (Effect of modelling on BDNF)**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_B_sexI <- subgroup_SMDI(df, "CvS", "BDNF", "Sex", 0.5)
SMD_S_B_SyRCLERoBI <- subgroup_SMDI(df, "CvS", "BDNF", "RoBScore", 0.5)
SMD_S_B_ARRIVEI <- subgroup_SMDI(df, "CvS", "BDNF", "ARRIVEScoreCat", 0.5)
```

The table below shows which of the covariates, if any, explain some of the heterogeneity observed in the effect of modelling on BDNF. We present marginal R^2^, which measures the proportion of variance explained by including moderators in the model (the % change in the between-studies variance when the covariate is included in the model, in other words the % of the heterogeneity explained by the variable). The coefficients are derived form an RMA model fitted with an intercept (and so represent, for each category, the point estimate and 95% CIs of the effect in that category).

|       Moderator        |      Category       |                     $\beta$                     |                                                95% CI                                                |                     Marginal R^2^ (%)                     |
|:------------:|:------------:|:------------:|:----------------:|:------------:|
|     Overall effect     |         \-          |         `r SMD_S_B[["SMD_ML"]]$beta[1]`         |                    `r SMD_S_B[["SMD_ML"]]$ci.lb` to `r SMD_S_B[["SMD_ML"]]$ci.ub`                    |                            \-                             |
|          Sex           |         \-          |                       \-                        |                                                  \-                                                  |        `r round((r2_ml(SMD_S_B_sexI)[1]*100),1)`%         |
|           \-           |      *Female*       |            `r SMD_S_B_sexI$beta[1]`             |                        `r SMD_S_B_sexI$ci.lb[1]` to `r SMD_S_B_sexI$ci.ub[1]`                        |                            \-                             |
|           \-           |       *Male*        |            `r SMD_S_B_sexI$beta[2]`             |                        `r SMD_S_B_sexI$ci.lb[2]` to `r SMD_S_B_sexI$ci.ub[2]`                        |                            \-                             |
| Reporting completeness |         \-          |                       \-                        |                                                  \-                                                  | `r round((r2_ml(SMD_S_B_ARR2$metaregression)[1]*100),1)`% |
|           \-           | *per unit increase* | `r SMD_S_B_ARR2$metaregression_summary$beta[2]` | `r SMD_S_B_ARR2$metaregression_summary$ci.lb[2]` to `r SMD_S_B_ARR2$metaregression_summary$ci.ub[2]` |                            \-                             |

### 3.5.5 Sensitivity Analyses

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen = 100, digits = 2)
```

We examine the robustness of the findings for BDNF by performing the following sensitivity analyses.

#### Imputed rho values of 0.2 and 0.8

In the previous analyses for the effect of single prolonged stress on BDNF, we imputed a $\rho$ value - the imputed within-study correlation between observed effect sizes - of 0.5. Here, we examine the effect of imputing $\rho$ values of 0.2 and 0.8.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_rho0.2 <- run_ML_SMD(df, "CvS", "BDNF", 0.2)
```

When the $\rho$ value is assumed to be 0.2, single prolonged stress had a pooled effect on BDNF of **SMD = `r SMD_S_B_rho0.2[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_B_rho0.2[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_B_rho0.2[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_B_rho0.2[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_B_rho0.2[["pred_interval"]][["pi.ub"]],3)`).

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_B_rho0.8 <- run_ML_SMD(df, "CvS", "BDNF", 0.8)
```

When the $\rho$ value is assumed to be 0.8, single prolonged stress had a pooled effect on BDNF of **SMD = `r SMD_S_B_rho0.8[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_B_rho0.8[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_B_rho0.8[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_B_rho0.8[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_B_rho0.8[["pred_interval"]][["pi.ub"]],3)`).

For reference the pooled effect size when rho is assumed to be 0.5 is `r SMD_S_B[["SMD_ML"]][["beta"]]` (95% CI: `r SMD_S_B[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_B[["SMD_ML"]][["ci.ub"]]`).

### 3.5.6 Reporting bias/small-study effects

Because of the relationship between SMD effect sizes and variance inherent in their calculation, where study size is small the standard approach to seeking evidence of small-study effects (regression based tests including Egger's regression test for multilevel meta-analysis) can lead to over-estimation of small-study effect (see for instance [10.7554/eLife.24260](10.7554/eLife.24260)). To address this we used Egger's regression test for multilevel meta-analysis, with regression of SMD effect size against 1/√N, where N is the total number of animals involved in an experiment.

```{r warning=FALSE, eval = TRUE, echo = FALSE}
run_sse_plot_SMD_L(df, 'CvS', 'BDNF')
#run_sse_NMD(df)
```

Egger regression based on `r run_sse_SMD_L(df, 'CvS', 'BDNF')[["k"]]` studies of modelling of depression where sucrose preference was measured showed a coefficient for a small-study effect of `r run_sse_SMD_L(df, 'CvS', 'BDNF')[["beta"]][2]` (95% CI: `r run_sse_SMD_L(df, 'CvS', 'BDNF')[["ci.lb"]][2]` to `r run_sse_SMD_L(df, 'CvS', 'BDNF')[["ci.ub"]][2]`; p = `r ifelse(run_sse_SMD_L(df, 'CvS', 'BDNF')[["pval"]][2] < 0.001, "<0.001", sprintf("%.3f", run_sse_SMD_L(df, 'CvS', 'BDNF')[["pval"]][2]))`).

## 3.6 Outcome 6: Biological stress response

### 3.6.1 Risks of bias

Figure 3.6.1 shows the risk of bias summary for studies investigating the effect of model induction on biological stress response in animals. The risk of bias assessment was performed using the SyRCLE RoB tool.

**Figure 3.6.1**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
SyRCLE_RoB_traffic(df, "CvS", "Stress response")
```

### 3.6.2 Reporting completeness

Figure 3.6.2 shows the reporting completeness summary for studies investigating the effect of model induction on biological stress response in animals. The reporting completeness assessment was performed using the ARRIVE guidelines.

**Figure 3.6.2**

```{r message = FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=8}
ARRIVE_traffic(df, "CvS", "Stress response")
```

### 3.6.3 Meta-analysis

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR <- run_ML_SMD(df, "CvS", "Stress response", 0.5)
```

The effect of single prolonged stress on the biological stress response in animals using SMD as the effect size is shown in Figure 3.6.3. The pooled estimate for SMD across all individual comparisons is displayed as a diamond shape at the bottom of the plot. Dotted lines indicate the prediction interval of the pooled estimate.

**Figure 3.6.3**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=6}
forest_metafor(SMD_S_StR, "CvS", "Stress response")
```

Single prolonged stress had a pooled effect on biological stress response of SMD = `r round(SMD_S_StR[["SMD_ML"]][['beta']], 3)`, (95% CI: `r round(SMD_S_StR[["SMD_ML"]][['ci.lb']], 3)` to `r round(SMD_S_StR[["SMD_ML"]][['ci.ub']], 3)`; 95% PrI: `r round(SMD_S_StR[["pred_interval"]][["pi.lb"]], 3)` to `r round(SMD_S_StR[["pred_interval"]][["pi.ub"]], 3)`).

`r SMD_S_StR[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_StR[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_StR[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_StR[["SMD_ML"]]$data$Strain))` different animal strain(s).

|       Level        |                                                          Number of categories for that level included in this analysis                                                          |                                                                              Attributable variance                                                                              |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_StR[["SMD_ML"]]$s.names, SMD_S_StR[["SMD_ML"]]$s.nlevels[[which(SMD_S_StR[["SMD_ML"]]$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_StR[["SMD_ML"]]$s.names, SMD_S_StR[["SMD_ML"]]$sigma2[[which(SMD_S_StR[["SMD_ML"]]$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR[["SMD_ML"]]$s.names, SMD_S_StR[["SMD_ML"]]$s.nlevels[[which(SMD_S_StR[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR[["SMD_ML"]]$s.names, SMD_S_StR[["SMD_ML"]]$sigma2[[which(SMD_S_StR[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

### 3.6.4 Subgroup analyses and meta-regressions

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen=100, digits=3)
```

For each outcome, the covariates of interest for subgroup analyses and meta-regressions were:

-   **Sex**

We also conducted subgroup analyses using **(1) SyRCLE Risk of Bias** and **(2) ARRIVE reporting completeness** assessment scores as covariates to evaluate their influence on effect size estimates. These were not specified in the study protocol, but evaluation of risk of bias is required for the Summary of Evidence table, and no studies were considered entirely at low risk of bias or of high reporting completeness to allow such a sensitivity analysis.

The significance (p-value) reported is that for a test of whether the moderators are significantly different one from another, rather than whether the effect is significantly different from 0.

#### **Sex**

Figure 3.6.4.1 displays the estimates for the pooled SMD's when comparisons are stratified by sex of the animal. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by sex, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 3.6.4.1 - Effect of single prolonged stress on biological stress response by Sex**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_sex <- subgroup_analysis(df, "CvS", "Stress response", "Sex", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "CvS", "Stress response", "Sex", SMD_S_StR_sex, SMD_S_StR)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_sex_noI <- subgroup_SMD(df, "CvS", "Stress response", "Sex", 0.5)
```

The p-value for the association between the sex of animal groups used and outcome reported was `r round(SMD_S_StR_sex_noI$QMp,3)`.

|       Level        |                                                           Number of categories for that level included in this analysis                                                            |                                                                               Attributable variance                                                                                |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_StR_sex$analysis$s.names, SMD_S_StR_sex$analysis$s.nlevels[[which(SMD_S_StR_sex$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_StR_sex$analysis$s.names, SMD_S_StR_sex$analysis$sigma2[[which(SMD_S_StR_sex$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_sex$analysis$s.names, SMD_S_StR_sex$analysis$s.nlevels[[which(SMD_S_StR_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_sex$analysis$s.names, SMD_S_StR_sex$analysis$sigma2[[which(SMD_S_StR_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considered as a categorical variable**

Figure 3.6.4.2 displays the estimates for the pooled SMD when comparisons are stratified by how many of the SyRCLE risk of bias assessment criteria (of which there are 10) that the experiment met. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by SyRCLE Risk of Bias, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 3.6.4.2 - Effect of single prolonged stress on biological stress response by SyRCLE RoB**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_StR_SyRCLERoB <- subgroup_analysis(df, "CvS", "Stress response", "RoBScore", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "CvS", "Stress response", "RoBScore", SMD_S_StR_SyRCLERoB, SMD_S_StR)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_SyRCLERoB_noI <- subgroup_SMD(df, "CvS", "Stress response", "RoBScore", 0.5)
```

The p-value for the association between SyRCLE Risks of Bias reporting and outcome reported was `r round(SMD_S_StR_SyRCLERoB_noI$QMp,3)`.

|       Level        |                                                                    Number of categories for that level included in this analysis                                                                     |                                                                                        Attributable variance                                                                                         |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_StR_SyRCLERoB$analysis$s.names, SMD_S_StR_SyRCLERoB$analysis$s.nlevels[[which(SMD_S_StR_SyRCLERoB$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_StR_SyRCLERoB$analysis$s.names, SMD_S_StR_SyRCLERoB$analysis$sigma2[[which(SMD_S_StR_SyRCLERoB$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_SyRCLERoB$analysis$s.names, SMD_S_StR_SyRCLERoB$analysis$s.nlevels[[which(SMD_S_StR_SyRCLERoB$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_SyRCLERoB$analysis$s.names, SMD_S_StR_SyRCLERoB$analysis$sigma2[[which(SMD_S_StR_SyRCLERoB$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considering those studies where any item is at low risk of bias**

Figure 3.6.4.3 displays the estimates for the pooled SMD when comparisons are stratified by whether of not any of the SyRCLE Risk of bias domains were rated as low risk of bias. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by SyRCLE Risk of Bias, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 3.6.4.3 - Effect of single prolonged stress on biological stress response by low SyRCLE RoB**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_StR_SyRCLERoBTF <- subgroup_analysis(df, "CvS", "Stress response", "RoBTF", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "CvS", "Stress response", "RoBTF", SMD_S_StR_SyRCLERoBTF, SMD_S_StR)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_SyRCLERoBTF_noI <- subgroup_SMD(df, "CvS", "Stress response", "RoBTF", 0.5)
```

The p-value for the association between low SyRCLE Risks of Bias reporting and outcome reported was `r round(SMD_S_StR_SyRCLERoBTF_noI$QMp,3)`.

|       Level        |                                                                       Number of categories for that level included in this analysis                                                                        |                                                                                           Attributable variance                                                                                            |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_StR_SyRCLERoBTF$analysis$s.names, SMD_S_StR_SyRCLERoBTF$analysis$s.nlevels[[which(SMD_S_StR_SyRCLERoBTF$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_StR_SyRCLERoBTF$analysis$s.names, SMD_S_StR_SyRCLERoBTF$analysis$sigma2[[which(SMD_S_StR_SyRCLERoBTF$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_SyRCLERoBTF$analysis$s.names, SMD_S_StR_SyRCLERoBTF$analysis$s.nlevels[[which(SMD_S_StR_SyRCLERoBTF$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_StR_SyRCLERoBTF$analysis$s.names, SMD_S_StR_SyRCLERoBTF$analysis$sigma2[[which(SMD_S_StR_SyRCLERoBTF$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **ARRIVE reporting completeness guidelines**

We provide a meta-regression where the number of ARRIVE items met is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_ARR2 <- metaregression_analysis(df, "CvS", "Stress response", "ARRIVEScore", 0.5)

```

**Figure 3.6.4.4 - Effect of single prolonged stress on biological stress response by ARRIVE reporting completeness**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE,}
SMD_S_StR_ARR2$regression_plot
```

The p-value for the association between ARRIVE reporting completeness and outcome reported was `r round(SMD_S_StR_ARR2$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                         Number of categories for that level included in this analysis                                                                                         |                                                                                                             Attributable variance                                                                                                             |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$sigma2[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$sigma2[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_StR_ARR2$metaregression_summary$s.names, SMD_S_StR_ARR2$metaregression_summary$sigma2[[which(SMD_S_StR_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Heterogeneity explained by covariates (Effect of modelling on Biological stress response)**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_StR_sexI <- subgroup_SMDI(df, "CvS", "Stress response", "Sex", 0.5)
SMD_S_StR_SyRCLERoBI <- subgroup_SMDI(df, "CvS", "Stress response", "RoBScore", 0.5)
SMD_S_StR_ARRIVEI <- subgroup_SMDI(df, "CvS", "Stress response", "ARRIVEScoreCat", 0.5)
```

The table below shows which of the covariates, if any, explain some of the heterogeneity observed in the effect of model induction on biological stress response. We present marginal R^2^, which measures the proportion of variance explained by including moderators in the model (the % change in the between-studies variance when the covariate is included in the model, in other words the % of the heterogeneity explained by the variable). The coefficients are derived form an RMA model fitted with an intercept (and so represent, for each category, the point estimate and 95% CIs of the effect in that category).

|       Moderator        |      Category       |                      $\beta$                      |                                                  95% CI                                                  |                      Marginal R^2^ (%)                      |
|:------------:|:------------:|:------------:|:----------------:|:------------:|
|     Overall effect     |         \-          |         `r SMD_S_StR[["SMD_ML"]]$beta[1]`         |                    `r SMD_S_StR[["SMD_ML"]]$ci.lb` to `r SMD_S_StR[["SMD_ML"]]$ci.ub`                    |                             \-                              |
|          Sex           |         \-          |                        \-                         |                                                    \-                                                    |        `r round((r2_ml(SMD_S_StR_sexI)[1]*100),1)`%         |
|           \-           |      *Female*       |            `r SMD_S_StR_sexI$beta[1]`             |                        `r SMD_S_StR_sexI$ci.lb[1]` to `r SMD_S_StR_sexI$ci.ub[1]`                        |                             \-                              |
|           \-           |       *Male*        |            `r SMD_S_StR_sexI$beta[2]`             |                        `r SMD_S_StR_sexI$ci.lb[2]` to `r SMD_S_StR_sexI$ci.ub[2]`                        |                             \-                              |
|      Risk of Bias      |         \-          |                        \-                         |                                                    \-                                                    |     `r round((r2_ml(SMD_S_StR_SyRCLERoBI)[1]*100),1)`%      |
|           \-           |  *0 criteria met*   |         `r SMD_S_StR_SyRCLERoBI$beta[1]`          |                  `r SMD_S_StR_SyRCLERoBI$ci.lb[1]` to `r SMD_S_StR_SyRCLERoBI$ci.ub[1]`                  |                             \-                              |
|           \-           |  *1 criteria met*   |         `r SMD_S_StR_SyRCLERoBI$beta[2]`          |                  `r SMD_S_StR_SyRCLERoBI$ci.lb[2]` to `r SMD_S_StR_SyRCLERoBI$ci.ub[2]`                  |                             \-                              |
| Reporting completeness |         \-          |                        \-                         |                                                    \-                                                    | `r round((r2_ml(SMD_S_StR_ARR2$metaregression)[1]*100),1)`% |
|           \-           | *per unit increase* | `r SMD_S_StR_ARR2$metaregression_summary$beta[2]` | `r SMD_S_StR_ARR2$metaregression_summary$ci.lb[2]` to `r SMD_S_StR_ARR2$metaregression_summary$ci.ub[2]` |                             \-                              |

### 3.6.5 Sensitivity Analyses

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen = 100, digits = 2)
```

We examine the robustness of the findings for biological stress response by performing the following sensitivity analyses.

#### Imputed rho values of 0.2 and 0.8

In the previous analyses for the effect of single prolonged stress on biological stress response, we imputed a $\rho$ value - the imputed within-study correlation between observed effect sizes - of 0.5. Here, we examine the effect of imputing $\rho$ values of 0.2 and 0.8.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_rho0.2 <- run_ML_SMD(df, "CvS", "Stress response", 0.2)
```

When the $\rho$ value is assumed to be 0.2, single prolonged stress had a pooled effect on biological stress response of **SMD = `r SMD_S_StR_rho0.2[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_StR_rho0.2[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_StR_rho0.2[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_StR_rho0.2[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_StR_rho0.2[["pred_interval"]][["pi.ub"]],3)`).

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_StR_rho0.8 <- run_ML_SMD(df, "CvS", "Stress response", 0.8)
```

When the $\rho$ value is assumed to be 0.8, single prolonged stress had a pooled effect on biological stress response of **SMD = `r SMD_S_StR_rho0.8[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_StR_rho0.8[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_StR_rho0.8[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_StR_rho0.8[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_StR_rho0.8[["pred_interval"]][["pi.ub"]],3)`).

For reference the pooled effect size when rho is assumed to be 0.5 is `r SMD_S_StR[["SMD_ML"]][["beta"]]` (95% CI: `r SMD_S_StR[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_StR[["SMD_ML"]][["ci.ub"]]`).

### 3.6.6 Reporting bias/small-study effects

Because of the relationship between SMD effect sizes and variance inherent in their calculation, where study size is small the standard approach to seeking evidence of small-study effects (regression based tests including Egger's regression test for multilevel meta-analysis) can lead to over-estimation of small-study effect (see for instance [10.7554/eLife.24260](10.7554/eLife.24260)). To address this we used Egger's regression test for multilevel meta-analysis, with regression of SMD effect size against 1/√N, where N is the total number of animals involved in an experiment.

```{r warning=FALSE, eval = TRUE, echo = FALSE}
run_sse_plot_SMD_L(df, 'CvS', 'Stress response')
#run_sse_NMD(df)
```

Egger regression based on `r run_sse_SMD_L(df, 'CvS', 'Stress response')[["k"]]` studies of modelling of depression where sucrose preference was measured showed a coefficient for a small-study effect of `r run_sse_SMD_L(df, 'CvS', 'Stress response')[["beta"]][2]` (95% CI: `r run_sse_SMD_L(df, 'CvS', 'Stress response')[["ci.lb"]][2]` to `r run_sse_SMD_L(df, 'CvS', 'Stress response')[["ci.ub"]][2]`; p = `r ifelse(run_sse_SMD_L(df, 'CvS', 'Stress response')[["pval"]][2] < 0.001, "<0.001", sprintf("%.3f", run_sse_SMD_L(df, 'CvS', 'Stress response')[["pval"]][2]))`).

## 3.7 Outcome 7: Neurotransmitter levels

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_NL <- run_SMD(df, "CvS", "Neurotransmitter levels")
# levels 3-3-2
```

Multilevel analysis is only performed if there are 5 levels or more for at least one of Strain, Study and Experiment, and that is not the case here. `r SMD_S_NL[["SMD_ML"]][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_NL[["SMD_ML"]]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_NL[["SMD_ML"]]$data$StudyId))` publications and involving `r length(unique(SMD_S_NL[["SMD_ML"]]$data$Strain))` different animal strain(s). We provide a conventional random effects model to illustrate the data. No subgroup analysis is performed. We also now include these freezing outcomes under the 'other neurobiological' heading below.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
forest_metafor(SMD_S_NL, "CvS", "Neurotransmitter levels")
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
# since freezing no longer considered separately, edit df to 'other behavioural'
column_name <- 'outcome_type'
condition <- df$SortLabel == "CvS" & df$outcome_type == "Neurotransmitter levels"
df[condition, column_name] <- 'Other neurobiological'
```

## 3.8 Outcome 8: Other neurobiological outcomes

### 3.8.1 Risks of bias

Figure 3.8.1 shows the risk of bias summary for studies investigating the effect of single prolonged stress on other neurobiological outcomes in animals. The risk of bias assessment was performed using the SyRCLE RoB tool.

**Figure 3.8.1**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
SyRCLE_RoB_traffic(df, "CvS", "Other neurobiological")
```

### 3.8.2 Reporting completeness

Figure 3.8.2 shows the reporting completeness summary for studies investigating the effect of single prolonged stress on other neurobiological outcomes in animals. The reporting completeness assessment was performed using the ARRIVE guidelines.

**Figure 3.8.2**

```{r message = FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height = 8}
ARRIVE_traffic(df, "CvS", "Other neurobiological")
```

### 3.8.3 Meta-analysis

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN <- run_ML_SMD(df, "CvS", "Other neurobiological", 0.5)
```

The effect of single prolonged stress on other neurobiological outcomes in animals using SMD as the effect size is shown in Figure 3.1.3. The pooled estimate for SMD across all individual comparisons is displayed as a diamond shape at the bottom of the plot. Dotted lines indicate the prediction interval of the pooled estimate.

**Figure 3.8.3**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, fig.height=12}
forest_metafor(SMD_S_OthN, "CvS", "Other neurobiological")
```

Single prolonged stress had a pooled effect on other neurobiological outcomes of SMD = `r round(SMD_S_OthN[['SMD_ML']][['beta']], 3)`, (95% CI: `r round(SMD_S_OthN[['SMD_ML']][['ci.lb']], 3)` to `r round(SMD_S_OthN[['SMD_ML']][['ci.ub']], 3)`; 95% PrI: `r round(SMD_S_OthN[["pred_interval"]][["pi.lb"]], 3)` to `r round(SMD_S_OthN[["pred_interval"]][["pi.ub"]], 3)`).

`r SMD_S_OthN[['SMD_ML']][["k"]]` experimental comparisons were reported in `r length(unique(SMD_S_OthN[['SMD_ML']]$data$ExperimentID_I))` experiments from `r length(unique(SMD_S_OthN[['SMD_ML']]$data$StudyId))` publications and involving `r length(unique(SMD_S_OthN[['SMD_ML']]$data$Strain))` different animal strain(s).

|       Level        |                                                           Number of categories for that level included in this analysis                                                            |                                                                               Attributable variance                                                                                |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OthN[["SMD_ML"]]$s.names, SMD_S_OthN[["SMD_ML"]]$s.nlevels[[which(SMD_S_OthN[["SMD_ML"]]$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OthN[["SMD_ML"]]$s.names, SMD_S_OthN[["SMD_ML"]]$sigma2[[which(SMD_S_OthN[["SMD_ML"]]$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OthN[["SMD_ML"]]$s.names, SMD_S_OthN[["SMD_ML"]]$s.nlevels[[which(SMD_S_OthN[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OthN[["SMD_ML"]]$s.names, SMD_S_OthN[["SMD_ML"]]$sigma2[[which(SMD_S_OthN[["SMD_ML"]]$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

### 3.8.4 Subgroup analyses and meta-regressions

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen=100, digits=3)
```

For each outcome, the covariates of interest for subgroup analyses and meta-regressions were:

-   **Sex**

We also conducted subgroup analyses using **(1) SyRCLE Risk of Bias** and **(2) ARRIVE reporting completeness** assessment scores as covariates to evaluate their influence on effect size estimates. These were not specified in the study protocol, but evaluation of risk of bias is required for the Summary of Evidence table, and no studies were considered entirely at low risk of bias or of high reporting completeness to allow such a sensitivity analysis.

The significance (p-value) reported is that for a test of whether the moderators are significantly different one from another, rather than whether the effect is significantly different from 0.

#### **Sex**

Figure 3.8.4.1 displays the estimates for the pooled SMD when comparisons are stratified by sex of the animal. Whiskers indicate the 95% confidence interval of each estimate. The overall pooled SMD, not stratified by sex, is displayed as a diamond shape at the bottom of the plot, with the 95% prediction interval shown as a red bar.

**Figure 3.8.4.1 - Effect of single prolonged stress on other neurobiological outcomes by Sex**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_sex <- subgroup_analysis(df, "CvS", "Other neurobiological", "Sex", 0.5)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', fig.height=3}
plot_subgroup_analysis(df, "CvS", "Other neurobiological", "Sex", SMD_S_OthN_sex, SMD_S_OthN)
```

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_sex_noI <- subgroup_SMD(df, "CvS", "Other neurobiological", "Sex", 0.5)
```

The p-value for the association between the sex of animal groups used and outcome reported was `r round(SMD_S_B_sex_noI$QMp,3)`.

|       Level        |                                                             Number of categories for that level included in this analysis                                                             |                                                                                 Attributable variance                                                                                 |
|:---------------:|:--------------------------:|:--------------------------:|
|       Study        |                `r ifelse('StudyId' %in% SMD_S_OthN_sex$analysis$s.names, SMD_S_OthN_sex$analysis$s.nlevels[[which(SMD_S_OthN_sex$analysis$s.names == 'StudyId')]], 0)`                |                `r ifelse('StudyId' %in% SMD_S_OthN_sex$analysis$s.names, SMD_S_OthN_sex$analysis$sigma2[[which(SMD_S_OthN_sex$analysis$s.names == 'StudyId')]], 'NA')`                |
| Study x Experiment | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OthN_sex$analysis$s.names, SMD_S_OthN_sex$analysis$s.nlevels[[which(SMD_S_OthN_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 0)` | `r ifelse('StudyId/ExperimentID_I' %in% SMD_S_OthN_sex$analysis$s.names, SMD_S_OthN_sex$analysis$sigma2[[which(SMD_S_OthN_sex$analysis$s.names == 'StudyId/ExperimentID_I')]], 'NA')` |

#### **SyRCLE RoB assessment considered as a categorical variable**

No studies met any RoB criteria.

#### **SyRCLE RoB assessment considering those studies where any item is at low risk of bias**

No studies met any RoB criteria.

#### **ARRIVE reporting completeness guidelines**

We provide a meta-regression where the number of ARRIVE items met is considered as a continuous variable.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_ARR2 <- metaregression_analysis(df, "CvS", "Other neurobiological", "ARRIVEScore", 0.5)

```

**Figure 3.8.4.2 - Effect of single prolonged stress on other neurobiological outcomes by ARRIVE reporting completeness**

```{r 2_8_4_5, eval=TRUE, echo=FALSE, message=FALSE, warning=FALSE}
SMD_S_OthN_ARR2$regression_plot
```

The p-value for the association between ARRIVE reporting completeness and outcome reported was `r round(SMD_S_OthN_ARR2$metaregression_summary$pval[2],3)`.

|            Level            |                                                                                          Number of categories for that level included in this analysis                                                                                           |                                                                                                              Attributable variance                                                                                                               |
|:---------------:|:--------------------------:|:--------------------------:|
|           Strain            |                        `r ifelse('Strain' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain')]], 0)`                        |                         `r ifelse('Strain' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$sigma2[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain')]], NA)`                         |
|       Study x Strain        |                `r ifelse('Strain/StudyId' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], 0)`                |                 `r ifelse('Strain/StudyId' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$sigma2[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain/StudyId')]], NA)`                 |
| Study x Strain x Experiment | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$s.nlevels[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 0)` | `r ifelse('Strain/StudyId/ExperimentID_I' %in% SMD_S_OthN_ARR2$metaregression_summary$s.names, SMD_S_OthN_ARR2$metaregression_summary$sigma2[[which(SMD_S_OthN_ARR2$metaregression_summary$s.names == 'Strain/StudyId/ExperimentID_I')]], 'NA')` |

#### **Heterogeneity explained by covariates (Effect of modelling on other neurobiological outcomes)**

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide', out.width = "100%"}
SMD_S_OthN_sexI <- subgroup_SMDI(df, "CvS", "Other neurobiological", "Sex", 0.5)
SMD_S_OthN_SyRCLERoBI <- subgroup_SMDI(df, "CvS", "Other neurobiological", "RoBScore", 0.5)
SMD_S_OthN_ARRIVEI <- subgroup_SMDIs(df, "CvS", "Other neurobiological", "ARRIVEScoreCat", 0.5)
```

The table below shows which of the covariates, if any, explain some of the heterogeneity observed in the effect of modelling on other neurobiological outcomes. We present marginal R^2^, which measures the proportion of variance explained by including moderators in the model (the % change in the between-studies variance when the covariate is included in the model, in other words the % of the heterogeneity explained by the variable). The coefficients are derived form an RMA model fitted with an intercept (and so represent, for each category, the point estimate and 95% CIs of the effect in that category).

|       Moderator        |      Category       |                      $\beta$                       |                                                   95% CI                                                   |                      Marginal R^2^ (%)                       |
|:------------:|:------------:|:------------:|:----------------:|:------------:|
|     Overall effect     |         \-          |         `r SMD_S_OthN[["SMD_ML"]]$beta[1]`         |                    `r SMD_S_OthN[["SMD_ML"]]$ci.lb` to `r SMD_S_OthN[["SMD_ML"]]$ci.ub`                    |                              \-                              |
|          Sex           |         \-          |                         \-                         |                                                     \-                                                     |        `r round((r2_ml(SMD_S_OthN_sexI)[1]*100),1)`%         |
|           \-           |      *Female*       |            `r SMD_S_OthN_sexI$beta[1]`             |                        `r SMD_S_OthN_sexI$ci.lb[1]` to `r SMD_S_OthN_sexI$ci.ub[1]`                        |                              \-                              |
|           \-           |       *Male*        |            `r SMD_S_OthN_sexI$beta[2]`             |                        `r SMD_S_OthN_sexI$ci.lb[2]` to `r SMD_S_OthN_sexI$ci.ub[2]`                        |                              \-                              |
| Reporting completeness |         \-          |                         \-                         |                                                     \-                                                     | `r round((r2_ml(SMD_S_OthN_ARR2$metaregression)[1]*100),1)`% |
|           \-           | *per unit increase* | `r SMD_S_OthN_ARR2$metaregression_summary$beta[2]` | `r SMD_S_OthN_ARR2$metaregression_summary$ci.lb[2]` to `r SMD_S_OthN_ARR2$metaregression_summary$ci.ub[2]` |                              \-                              |

### 3.8.5 Sensitivity Analyses

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
options(scipen = 100, digits = 2)
```

We examine the robustness of the findings for other neurobiological outcomes by performing the following sensitivity analyses

#### Imputed rho values of 0.2 and 0.8

In the previous analyses for the effect of single prolonged stress on other neurobiological outcomes, we imputed a $\rho$ value - the imputed within-study correlation between observed effect sizes - of 0.5. Here, we examine the effect of imputing $\rho$ values of 0.2 and 0.8.

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_rho0.2 <- run_ML_SMD(df, "CvS", "Other neurobiological", 0.2)
```

When the $\rho$ value is assumed to be 0.2, single prolonged stress had a pooled effect on other neurobiological outcomes of **SMD = `r SMD_S_OthN_rho0.2[["SMD_ML"]][["beta"]]`** (95% CI: `r SMD_S_OthN_rho0.2[["SMD_ML"]][["ci.lb"]]` to `r SMD_S_OthN_rho0.2[["SMD_ML"]][["ci.ub"]]`; 95% PrI: `r round(SMD_S_OthN_rho0.2[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_OthN_rho0.2[["pred_interval"]][["pi.ub"]],3)`).

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE, results='hide'}
SMD_S_OthN_rho0.8 <- run_ML_SMD(df, "CvS", "Other neurobiological", 0.8)
```

When the $\rho$ value is assumed to be 0.8, single prolonged stress had a pooled effect on other neurobiological outomes of **SMD = `r round(SMD_S_OthN_rho0.8[["SMD_ML"]][["beta"]],3)`** (95% CI: `r round(SMD_S_OthN_rho0.8[["SMD_ML"]][["ci.lb"]],3)` to `r round(SMD_S_OthN_rho0.8[["SMD_ML"]][["ci.ub"]],3)`; 95% PrI: `r round(SMD_S_OthN_rho0.8[["pred_interval"]][["pi.lb"]],3)` to `r round(SMD_S_OthN_rho0.8[["pred_interval"]][["pi.ub"]],3)`).

For reference the pooled effect size when rho is assumed to be 0.5 is `r round(SMD_S_OthN[['SMD_ML']][["beta"]],3)` (95% CI: `r round(SMD_S_OthN[['SMD_ML']][["ci.lb"]],3)` to `r round(SMD_S_OthN[['SMD_ML']][["ci.ub"]],3)`).

### 3.8.6 Reporting bias/small-study effects

Because of the relationship between SMD effect sizes and variance inherent in their calculation, where study size is small the standard approach to seeking evidence of small-study effects (regression based tests including Egger's regression test for multilevel meta-analysis) can lead to over-estimation of small-study effect (see for instance [10.7554/eLife.24260](10.7554/eLife.24260)). To address this we used Egger's regression test for multilevel meta-analysis, with regression of SMD effect size against 1/√N, where N is the total number of animals involved in an experiment.

```{r warning=FALSE, eval = TRUE, echo = FALSE}
run_sse_plot_SMD_L(df, 'CvS', 'Other neurobiological')
#run_sse_NMD(df)
```

Egger regression based on `r run_sse_SMD_L(df, 'CvS', 'Other neurobiological')[["k"]]` studies of modelling of depression where other neurobiological outcomes was measured showed a coefficient for a small-study effect of `r run_sse_SMD_L(df, 'CvS', 'Other neurobiological')[["beta"]][2]` (95% CI: `r run_sse_SMD_L(df, 'CvS', 'Other neurobiological')[["ci.lb"]][2]` to `r run_sse_SMD_L(df, 'CvS', 'Other neurobiological')[["ci.ub"]][2]`; p = `r ifelse(run_sse_SMD_L(df, 'CvS', 'Other neurobiological')[["pval"]][2] < 0.001, "<0.001", sprintf("%.3f", run_sse_SMD_L(df, 'CvS', 'Other neurobiological')[["pval"]][2]))`).

# 4. Observed relationships between different outcomes measures in the same cohorts of animals

We selected cohorts where at least one outcome was presented for at least two outcome types. Where there were two or more of the same outcome type within a cohort, we calculated a standardised mean difference effect size for that outcome in that cohort, along with its standard error. Where there was a single effect size within a cohort, we took the standard error of that effect size.

Then, for each pair of outcome measures we plotted the effect sizes for each cohort, and fitted a regression line weighted on the standard error in the outcome measure represented on the x-axis. Outcome measure pairs are coded according to whether they come from model induction studies (red, expectation of worsening anhedonia) or from intervention studies (green, expectation of improvement in anhedonia). The number of experimental comparisons observed from each cohort is reflected in the size of the symbol, and shown in the figure legend.

We show pairwise relationships where there were at least 3 experimental cohorts for either modelling experiments, intervention experiments, or both, and provide the relevant regression coefficient(s). We also provide an overall representation of all paired neurobiological effect sizes with the corresponding behavioural outcome in that cohort.

**4.1 Relationship between change in locomotor activity and change in 'other' neurobiological outcomes**

![](plot_2_9.png)

**4.2 Relationship between change in freezing behaviour and change in 'other' behavioural outcomes**

![](plot_3_5.png)

**4.3 Relationship between change in BDNF and change in 'other' behavioural outcomes**

![](plot_5_6.png)

**4.4 Relationship between change in stress response and change in 'other' behavioural outcomes**

![](plot_5_7.png)

**4.5 Relationship between change in 'other' neurobiological outcomes and change in 'other' behavioural outcomes**

![](plot_5_9.png)

**4.6 Relationship between change in stress response and change in BDNF**

![](plot_6_7.png)

**4.7 Relationship between change in 'other' neurobiological outcomes and change in BDNF**

![](plot_6_9.png)

**4.8 Relationship between change in 'other' neurobiological outcomes and change in stress response**

![](plot_7_9.png)

**4.9 Relationship between change in all neurobiological outcomes and all behavioural outcomes**

![](BvN.png)

# 5. Attrition bias and adverse effects of treatment

```{r message=FALSE, warning=FALSE, eval = TRUE, echo = FALSE}
#### calculate non completion rate
c1 <- which(colnames(df) == "n allocated to group at experiment start?")
c2 <- which(colnames(df) == "n allocated to group at experiment start?_C")
c3 <- which(colnames(df) == "n allocated to group at experiment start?_I")
c4 <- which(colnames(df) == "F_S_n")
c5 <- which(colnames(df) == "F_C_n")
c6 <- which(colnames(df) == "F_T_n")

Nsdf <- df[,c(c2,c3,c5,c6)]
Nsdf <- subset(Nsdf, !Nsdf$`n allocated to group at experiment start?_C` == 999)
Nsdf <- subset(Nsdf, !Nsdf$`n allocated to group at experiment start?_C` == 9999)
Nsdf <- subset(Nsdf, !Nsdf$`n allocated to group at experiment start?_I` == 999)
Nsdf <- subset(Nsdf, !Nsdf$`n allocated to group at experiment start?_I` == 9999)
Nsdf$closs <- Nsdf$`n allocated to group at experiment start?_C` - Nsdf$F_C_n
Nsdf$tloss <- Nsdf$`n allocated to group at experiment start?_I` - Nsdf$F_T_n

Nsdf$cprop <- Nsdf$closs/Nsdf$`n allocated to group at experiment start?_C`
Nsdf$tprop <- Nsdf$closs/Nsdf$`n allocated to group at experiment start?_I`


ctot <- sum(Nsdf$`n allocated to group at experiment start?_C`)
ttot <- sum(Nsdf$`n allocated to group at experiment start?_I`)
cltot <- sum(Nsdf$closs)
tltot <- sum(Nsdf$tloss)
closs <- cltot/ctot
tloss <- tltot/ttot

#dfi1 <- subset(df, !is.na(df$`Treatment dosing regime:[1]_I`))
#dfi2 <- subset(df, !is.na(df$`Treatment dosing regime:[2]_I`))
#dfi1a <- as.data.frame(dfi1$`Treatment dosing regime:[1]_I`)
#dfi2a <- as.data.frame(dfi2$`Treatment dosing regime:[2]_I`)
#colnames(dfi1a) <- colnames(dfi2a) <- "Regime"
#dfi <- rbind(dfi1a, dfi2a)
#dfis <- subset(dfi, dfi$Regime == "Single dose")
#dfisn <- nrow(dfis)
#dfin <- nrow(dfi)
#dfiper <- (dfisn/dfin)*100

```

We know of `r ctot` animals in Control cohorts and `r ttot` animals in Intervention cohorts, of which `r closs*100`% and `r tloss*100`% were reported to have 'dropped out' between allocation to group and outcome measurement. This analysis assumes full reporting of animals excluded from analyses, and it may be that group sizes were specified 'after the event', or that there was unreported replacement of animals excluded during the experiment, so these data should be interpreted with caution.

# 6. Summary of the evidence

## 6.1 Effect of exercise versus control in animals exposed to single prolonged stress

```{r echo = FALSE}
SoE_TvC <- read_xlsx("data/soe_tables_20240429.xlsx", "TvC")

knitr::kable(SoE_TvC) %>%
  kable_styling(bootstrap_options = "bordered")

```

## 6.2 Effect of single prolonged stress, without treatment, compared with animals not exposed to single prolonged stress

To provide context for the effects of exercise in these models, we also present a summary of the effects of model induction.

```{r echo = FALSE}
SoE_CvS <- read_xlsx("data/soe_tables_20240429.xlsx", "CvS")

knitr::kable(SoE_CvS) %>%
  kable_styling(bootstrap_options = "bordered")

```

Rationale for conclusions for indirectness: 

**[1] Effect of exercise on behavioural outcomes in PTSD: Moderate risk of indirectness** 
Locomotor activity is increased following treatment, but in humans hyperlocomotion may be observed as a feature of PTSD, and is thought to reflect agitation. Other behavioural outcomes reported (fear memory, freezing, anxiety and cognitive impairment) have good Ethological validity, with clinically relevant human correlates. 

**[2] Effect of exercise on neurobiological outcomes in PTSD: Moderate risk of indirectness** 
BDNF levels are increased following treatment, and while PTSD is associated with increased BDNF levels in humans, there is also a reported association between high levels of BDNF and greater response to treatment. Similarly, changes in stress physiology are seen here and are associated with improved outcomes in human PTSD. We saw no significant change in neurotransmitter levels. Only one study reported serotonin levels, showing reduced hippocampal and prefrontal cortex serotonin (5-HT) following SPS, with reversal of hippocampal but not prefrontal cortex following treatment. Serum serotonin levels are reportedly reduced in people with PTSD.

**[3] Validity of the single prolonged stress model: Mild to moderate risk of indirectness**
The single prolonged stress model has reasonable Homological, Triggering, Induction, and Remission validity. No studies included an early 'priming' exposure which might give Ontopathogenic validity, and there was no significant effect of exercise on Freezing behaviour (although the number of included studies was low, and the point estimate favoured an effect). The elevated levels of BDNF seen in human PTSD were not seen in animal models (there was a non significant reduction in BDNF levels), when tested 4 weeks after induction, giving reduced Biomarker validity.Markers of physiological stress were increased by SPS, consistent with findings in humans; and there was no effect on neurotransmiter levels or on other neurobiological markers such as the abundance of Bax or Bcl-2.

## Evaluation of indirectness of evidence (based on criteria in document "Assessing the certainty of evidence in animal studies") for the studies included in the review

The framework for the evaluation of indirectness is based on eight dimensions, based on the work of Belzung and Lemoine, and comprising **(i) Homological validity** - what is the extent of homology between the model organism and humans relevant to the condition studied; **(ii) Ontopathogenic validity** - Does the model include prenatal or early life exposures inducing transition from initial organism to vulnerable organism; **(iii) Triggering validity** - are any triggering factors used in the modelling -- or their homologues -known to induce psychosis or relapse in humans?; **(iv) Mechanistic validity** - whether the neurobiological or cognitive mechanisms which operate in human disease can be observed in the animal model; **(v) Induction validity** - Does the induction of the disease model induce changes in biomarkers (see below) which are known to be altered in human disease?; **(vi) Remission validity** - What is the effect of other drugs known to be effective in humans in the particular animal model / outcome measure pair? ; **(vii) Biomarker validity** - are changes in disease markers (eg neurotransmitter levels, structural brain imaging) seen in human disease also seen in this animal model?; and **(viii) Ethological validity** - what is the 'behavioural distance' between the model phenotype in animals and the symptoms and signs of human disease at which treatment is targeted?

```{r echo = FALSE}
SoE_Indir <- read_xlsx("data/soe_tables_20240429.xlsx", "Indir") ### ? where is this##

knitr::kable(SoE_Indir) %>%
  kable_styling(bootstrap_options = "bordered")

```

The description of the criteria is available at <https://doi.org/10.17605/OSF.IO/TDMAU>

## Evaluation of the concordance between different outcome measures

We were only able to evaluate this where there were data for pairs of outcome measures from at least three different experimental cohorts. Mapping all behavioural outcomes (which might be considered 'apical' or more clinically relevant) against all neurobiological outcomes (which might be considered intermediate or mechanistic outcomes), there was reasonable correlation (r<sup>2</sup> = 0.37) in effects of model induction, but not for the effects of exercise (r<sup>2</sup> = 0.07). 

There were insufficient data to compare different behavioural outcome measures except for freezing behaviour compared with other behaviours for exercise treatment, where there was no relationship (r<sup>2</sup> = 0.02).

Within Neurobiological responses, there was good agreement between effects on BDNF and effects on the stress response for both model induction (r<sup>2</sup> = 0.43) and exercise treatment (r<sup>2</sup> = 0.81); between effects on BDNF and effects on other neurobiological outcomes for both model induction (r<sup>2</sup> = 0.49) and exercise treatment (r<sup>2</sup> = 0.59); and between effects on the stress response and effects on other neurobiological outcomes for both model induction (r<sup>2</sup> = 0.27) and exercise treatment (r<sup>2</sup> = 0.97).

Finally, we mapped individual neurobiological ('intermediate') outcomes against all behavioural outcomes (not shown). There was some agreement between effects on BDNF and effects on all behavioural outcomes for both model induction (r<sup>2</sup> = 0.21) and exercise treatment (r<sup>2</sup> = 0.25) and between effects on the stress response and effects on all behavioural outcomes for both model induction (r<sup>2</sup> = 0.29) and exercise treatment (r<sup>2</sup> = 0.14).



# 7. Software used

```{r echo=FALSE}
grateful::cite_packages(output = "paragraph", pkgs = "Session", out.dir = ".")
```
